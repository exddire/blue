<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>test - Release 4</bpr:name>
    <bpr:release-notes />
    <bpr:created>2020-12-15 12:46:09Z</bpr:created>
    <bpr:package-id>7</bpr:package-id>
    <bpr:package-name>test</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="4">
        <process id="ea1de96a-ddbb-4a04-a61a-0038894ea7a6" name="Eliminación comisiones web pyme - Main" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Eliminación comisiones web pyme - Main" version="1.0" bpversion="6.9.0.26970" narrative="" byrefcollection="true"><view><camerax>140</camerax><cameray>-334</cameray><zoom version="2">1.25</zoom></view><preconditions><condition narrative="Eliminación comisiones web pyme " /></preconditions><endpoint narrative="" /><subsheet subsheetid="49162dbf-68b6-42e8-bd44-dcc510422003" type="Normal" published="False"><name>Extraer casos de google sheet</name><view><camerax>15</camerax><cameray>147</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f094c90e-f9d1-443e-8259-86680cc9b2ab" type="Normal" published="False"><name>Envío de Resultado</name><view><camerax>17</camerax><cameray>57</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="6fc835b8-db42-4f97-960d-4b19fb7daddb" name="Start" type="Start"><display x="-60" y="-540" /><onsuccess>30409a61-3d74-41ca-8737-8d4b786cb91d</onsuccess></stage><stage stageid="60f867f5-6461-45ff-92ee-83cbf638d400" name="End" type="End"><display x="-60" y="705" /></stage><stage stageid="91a3dd6b-1fbe-40d8-81a4-d1cd6133c8ed" name="Stage1" type="ProcessInfo"><display x="-255" y="-150" w="150" h="90" /></stage><stage stageid="11b2a00b-c245-4f4e-9b18-1b171465b11b" name="Lanzar Webbel" type="Process"><loginhibit onsuccess="true" /><display x="-60" y="-15" /><inputs><input type="text" name="Usuario" friendlyname="Usuario" expr="[Usuario]" /><input type="password" name="Contraseña" friendlyname="Contraseña" expr="[Password]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" stage="Success Login" /><output type="text" name="Tipo error" friendlyname="Tipo error" stage="Tipo error" /><output type="text" name="Mensaje error" friendlyname="Mensaje error" stage="Mensaje error" /></outputs><onsuccess>e91176c9-9c6c-4695-8d37-6376c9f4c101</onsuccess><processid>06b69dc0-fbc1-44aa-a86e-d1a3e000e67e</processid></stage><stage stageid="bc4e43fb-bb81-424d-b6cf-240fdf817985" name="Actualiza Comisión" type="Process"><loginhibit onsuccess="true" /><display x="315" y="210" /><inputs><input type="text" name="Rut" friendlyname="Rut" expr="[Rut]" /><input type="text" name="Convenio" friendlyname="Convenio" expr="[Casos.nroConvenio]" /><input type="text" name="DV" friendlyname="DV" expr="[DV]" /><input type="text" name="Nombre Archivo Log" friendlyname="Nombre Archivo Log" narrative="Nombre del archivo de log para errores" expr="[Rut]&amp;&quot;_&quot;&amp;FormatDateTime(Today(), &quot;yyyyMMdd&quot;)&amp;&quot;_&quot;&amp;Replace(LocalTime(),&quot;:&quot;,&quot;&quot;)&amp;&quot;.log&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" stage="Success Proceso" /><output type="text" name="Tipo error" friendlyname="Tipo error" stage="Tipo error" /><output type="text" name="Mensaje error" friendlyname="Mensaje error" stage="Mensaje error" /></outputs><onsuccess>adc36858-b5bc-423e-8e0c-fee34499c1ed</onsuccess><processid>03682dff-0063-45aa-b544-b9e1e2d3c7b1</processid></stage><stage stageid="cecf5c12-5872-4d4d-b9bb-8a36843b42c5" name="Loop Casos" type="LoopStart"><loginhibit onsuccess="true" /><display x="-60" y="165" /><onsuccess>3d8382f6-3d75-48f3-80f8-5d25cd9eb708</onsuccess><groupid>45c21163-afcc-4d33-97e7-71c208c1f597</groupid><looptype>ForEach</looptype><loopdata>Casos</loopdata></stage><stage stageid="d7507cea-0715-47b8-9d9a-f06a43a0ac6e" name="Loop Casos" type="LoopEnd"><loginhibit onsuccess="true" /><display x="-60" y="375" /><onsuccess>33532558-e5d4-42d5-aa3d-a002d850c333</onsuccess><groupid>45c21163-afcc-4d33-97e7-71c208c1f597</groupid></stage><stage stageid="241b4a51-7eee-4430-8cce-5f0e928f7e28" name="Extraer casos de google sheet" type="SubSheetInfo"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-180" y="-75" w="150" h="90" /></stage><stage stageid="c2ee7532-24c6-4f74-87ef-000122ae37b3" name="Start" type="Start"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="15" y="-45" /><onsuccess>3a2bd55d-c470-43a7-abbe-d0225a9d5771</onsuccess></stage><stage stageid="0e219512-2156-4749-a9cd-89dec13f9b39" name="End" type="End"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="240" y="345" /><outputs><output type="collection" name="Casos" stage="Input" /><output type="flag" name="Success Sheet" stage="Success Sheet" /></outputs></stage><stage stageid="a9685480-b0e9-4e28-a933-df9bcaa1246d" name="Extraer casos de google sheet" type="SubSheet"><loginhibit onsuccess="true" /><display x="-60" y="-375" w="90" h="60" /><outputs><output type="collection" name="Casos" friendlyname="Casos" stage="Casos" /><output type="flag" name="Success Sheet" friendlyname="Success Sheet" stage="Success Sheet" /></outputs><onsuccess>844742ee-6e27-44f9-8dd4-cc1ae1065496</onsuccess><processid>49162dbf-68b6-42e8-bd44-dcc510422003</processid></stage><stage stageid="705a9c73-5d19-4ff1-9006-787c210ebf83" name="Usuario" type="Data"><loginhibit onsuccess="true" /><display x="-285" y="-60" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8370dee8-df4f-427d-926c-3e7e79ed3dcd" name="Password" type="Data"><loginhibit onsuccess="true" /><display x="-225" y="-60" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="93ca3970-49d9-4b77-8910-f227cff1126b" name="Envío de Resultado" type="SubSheet"><loginhibit onsuccess="true" /><display x="-60" y="555" /><inputs><input type="collection" name="Casos Procesados" friendlyname="Casos Procesados" expr="[Casos Procesados]" /></inputs><onsuccess>a2abc84b-1081-444d-a0fc-c43635eba191</onsuccess><processid>f094c90e-f9d1-443e-8259-86680cc9b2ab</processid></stage><stage stageid="fe81ca61-4360-4a41-ab93-334cdbd0b351" name="Casos" type="Collection"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-225" y="225" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cc443dc8-e589-499f-bd4b-ed6b0be55e9e" name="Casos" type="Collection"><display x="-225" y="60" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="mailSolicitante" type="text" /><field name="nroConvenio" type="text" /><field name="mailIngresador" type="text" /><field name="rutEmpresa" type="text" /></collectioninfo></stage><stage stageid="51640240-ccdf-4add-aa9f-67bf163eeeae" name="Total casos" type="Data"><display x="-300" y="60" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c830210a-c2d8-4f4e-904f-baa4c8a216c4" name="hay Casos?" type="Decision"><display x="-60" y="-165" /><decision expression="[Total casos] &gt; 0 and ( [Casos.mailIngresador] &lt;&gt;&quot;--&quot; and [Casos.mailSolicitante] &lt;&gt;&quot;--&quot; and [Casos.nroConvenio] &lt;&gt;&quot;--&quot; and [Casos.rutEmpresa] &lt;&gt;&quot;--&quot;)" /><ontrue>6af78a67-3794-4fc1-9bde-4428d0103ee5</ontrue><onfalse>44c2f3a5-f2b1-4475-894b-1697f5f5acad</onfalse></stage><stage stageid="53e67bbf-b592-4c8a-b996-ce9c4c695c3d" name="End1" type="End"><loginhibit onsuccess="true" /><display x="375" y="-165" /></stage><stage stageid="6af78a67-3794-4fc1-9bde-4428d0103ee5" name="Credentials::Get" type="Action"><loginhibit onsuccess="true" /><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><display x="-60" y="-60" /><inputs><input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="&quot;PV_PNOL_WEBBEL&quot;" /></inputs><outputs><output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Password" /><output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Usuario" /><output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="Expiry Date" /><output type="text" name="Status" friendlyname="Status" narrative="The status" stage="Status" /></outputs><onsuccess>11b2a00b-c245-4f4e-9b18-1b171465b11b</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="0614fa5d-fe22-4200-972b-b26e0fd87dfc" name="Expiry Date" type="Data"><display x="-285" y="-15" /><datatype>date</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7c5b3414-5752-41f2-ae39-aa6d61824357" name="Status" type="Data"><display x="-225" y="-15" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3244d193-6310-48cf-8e06-8e22259316ac" name="Credenciales" type="Block"><loginhibit onsuccess="true" /><display x="-330" y="-90" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="FFFF00" /></stage><stage stageid="ef03b67d-b3f1-4994-a97e-2b94679f475b" name="Actualizar Comisión" type="Block"><loginhibit onsuccess="true" /><display x="270" y="180" w="165" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ffcba9db-cd80-4774-b09c-b490ac2047b2" name="Lanzar Webbel" type="Block"><loginhibit onsuccess="true" /><display x="-135" y="-90" w="165" h="105" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="aecf854f-f814-44e6-9d07-e671617cdcb5" name="Recover Actuliza Comisión" type="Recover"><loginhibit /><display x="390" y="210" /><onsuccess>cb924248-8001-4b64-9c0e-fa5f8cdb30a7</onsuccess></stage><stage stageid="e873bd65-5c42-45b4-b2bf-f272443889e8" name="Get JSON" type="Action"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="15" y="180" /><outputs><output type="collection" name="Input" stage="Input" /></outputs><onsuccess>da499b08-adc3-4ec2-8e2a-7eff363c0b86</onsuccess><resource object="Webbel - Service REST" action="Get JSON" /></stage><stage stageid="0aa46c89-bbbd-4b9d-8e1f-3c8feef6d9d4" name="Google Account::Launch" type="Action"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="15" y="45" /><onsuccess>5f8c73ca-6d98-4cbf-a465-6e15f9910613</onsuccess><resource object="Chrome - Google Account Login extensión" action="Launch" /></stage><stage stageid="3a2bd55d-c470-43a7-abbe-d0225a9d5771" name="Get Credentials" type="Action"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit /><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><display x="15" y="0" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials to get" expr="&quot;GLOBAL_GMAIL_ENVIO-CORREO&quot;" /></inputs><outputs><output type="password" name="Password" narrative="The password" stage="Clave" /><output type="text" name="Username" narrative="The user name" stage="Usuario" /><output type="date" name="Expiry Date" narrative="The expiry date" stage="Expiry Date" /><output type="text" name="Status" narrative="The status" stage="Status" /></outputs><onsuccess>0aa46c89-bbbd-4b9d-8e1f-3c8feef6d9d4</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="5f8c73ca-6d98-4cbf-a465-6e15f9910613" name="Google Account::Login" type="Action"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="15" y="90" /><inputs><input type="text" name="Usuario" friendlyname="Usuario" narrative="Nombre del usuario a ingresar al aplicativo." expr="[Usuario]" /><input type="password" name="Clave" friendlyname="Clave" narrative="Clave del usuario a ingresar al aplicativo." expr="[Clave]" /></inputs><onsuccess>5ff911f3-81f4-49cb-8b2b-5cc428a87abe</onsuccess><resource object="Chrome - Google Account Login extensión" action="Login" /></stage><stage stageid="6b2ec424-3dea-4943-9820-101739f89bc2" name="Chrome Cierra Pestaña" type="Action"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="15" y="345" /><onsuccess>0e219512-2156-4749-a9cd-89dec13f9b39</onsuccess><resource object="Chrome - Google Account Login extensión" action="Cierre Pestaña" /></stage><stage stageid="5ff911f3-81f4-49cb-8b2b-5cc428a87abe" name="Navega url" type="Action"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="15" y="135" /><inputs><input type="text" name="url" friendlyname="url" expr="[URL - Pnol json]" /></inputs><onsuccess>e873bd65-5c42-45b4-b2bf-f272443889e8</onsuccess><resource object="Chrome - Google Account Login extensión" action="Navigate" /></stage><stage stageid="bdbd9d15-a434-4e56-9ddd-57a9f2441326" name="Usuario" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="15" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="97e92873-92f0-4884-9ec8-0bb11ac5571c" name="Clave" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="60" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="613bf91b-7426-4262-bbab-ca393108ea4b" name="Post ok" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-150" y="135" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3e46ea20-54d9-44dc-85ba-7383b8ee94b1" name="URL - Pnol json" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="180" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><private /><alwaysinit /></stage><stage stageid="70a6239e-90de-4e00-9063-6bb735fc2bba" name="VARIABLES" type="Block"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="105" w="165" h="150" /><font family="Segoe UI" size="10" style="Regular" color="800080" /></stage><stage stageid="699f1dfa-bec4-4728-8ac7-197fc6dc7ec3" name="End1" type="End"><loginhibit onsuccess="true" /><display x="750" y="210" /></stage><stage stageid="6b35010e-5262-4444-ab06-6d230f4cc986" name="DV" type="Data"><display x="-225" y="105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e4851def-080f-4ce9-acc2-eff517aaab02" name="Separar RUT y DV" type="Action"><loginhibit onsuccess="true" /><display x="30" y="210" /><inputs><input type="text" name="RUT" friendlyname="RUT" narrative="Rut a separar" expr="[Casos.rutEmpresa]" /></inputs><outputs><output type="text" name="RUT" friendlyname="RUT" stage="Rut" /><output type="text" name="DV" friendlyname="DV" stage="DV" /></outputs><onsuccess>bd9306b2-2e61-421e-b69d-96a9bb7e277a</onsuccess><resource object="Utility - RUT" action="Separar RUT y DV" /></stage><stage stageid="a29cecaa-d56f-4dff-8cf4-74143ad1eb95" name="Cola de Trabajo" type="Block"><loginhibit onsuccess="true" /><display x="-330" y="30" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="06ef8d7f-b528-493a-a485-7651706ec45e" name="Success Login" type="Data"><display x="-345" y="285" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fde73b86-f482-46e8-a635-78376c420f0d" name="Tipo error" type="Data"><display x="-345" y="315" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0344c41d-2e06-4152-8456-d39abc1805fd" name="Mensaje error" type="Data"><display x="-345" y="345" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b44543af-0366-4c1c-9377-e0fd4e649b2c" name="Manejo de errores" type="Block"><loginhibit onsuccess="true" /><display x="-390" y="255" w="255" h="150" /><font family="Segoe UI" size="10" style="Regular" color="FF0000" /></stage><stage stageid="44c2f3a5-f2b1-4475-894b-1697f5f5acad" name="Envío de Resultado" type="SubSheet"><loginhibit onsuccess="true" /><display x="15" y="-165" /><inputs><input type="collection" name="Casos Procesados" friendlyname="Casos Procesados" expr="[Casos]" /></inputs><onsuccess>35d38a84-eaf7-4dba-b094-f0b46c227814</onsuccess><processid>f094c90e-f9d1-443e-8259-86680cc9b2ab</processid></stage><stage stageid="e91176c9-9c6c-4695-8d37-6376c9f4c101" name="Login Exitoso?" type="Decision"><display x="-60" y="60" /><decision expression="[Success Login]" /><ontrue>cecf5c12-5872-4d4d-b9bb-8a36843b42c5</ontrue><onfalse>afde3373-5daf-45a4-9e37-2d44e0d623b4</onfalse></stage><stage stageid="fc1a77c8-553c-45ba-9383-fece848dea22" name="Exception Login" type="Exception"><display x="195" y="60" /><exception localized="yes" type="System Exception" detail="&quot;Login No Exitoso&quot;" /></stage><stage stageid="464bfd7d-794d-462f-96ba-fe302b3c5fca" name="Guarda Salida" type="MultipleCalculation"><loginhibit onsuccess="true" /><display x="165" y="375" /><onsuccess>8eaecb2a-18fc-4eee-ac69-be7894095af6</onsuccess><steps><calculation expression="[Casos.mailIngresador]" stage="Casos Procesados.mailIngresador" /><calculation expression="[Casos.mailSolicitante]" stage="Casos Procesados.mailSolicitante" /><calculation expression="[Casos.nroConvenio]" stage="Casos Procesados.nroConvenio" /><calculation expression="[Casos.rutEmpresa]" stage="Casos Procesados.rutEmpresa" /><calculation expression="[Mensaje]" stage="Casos Procesados.Mensaje" /><calculation expression="[Variable Estado para Sheet]" stage="Casos Procesados.Estado" /><calculation expression="[Fin]" stage="Coll a BD.fecha_termino" /><calculation expression="[Variable Estado para Sheet]" stage="Coll a BD.status" /><calculation expression="[Mensaje]&amp;&quot; para rut : &quot;&amp;[Casos.rutEmpresa]&amp;&quot; Convenio :&quot;&amp;[Casos.nroConvenio]" stage="Coll a BD.mensaje" /></steps></stage><stage stageid="02d87fe3-db12-44b5-bd36-f8aee3131800" name="Casos Procesados" type="Collection"><display x="-270" y="315" w="90" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="mailSolicitante" type="text" /><field name="nroConvenio" type="text" /><field name="mailIngresador" type="text" /><field name="rutEmpresa" type="text" /><field name="Mensaje" type="text" /><field name="Estado" type="text" /></collectioninfo></stage><stage stageid="9bead92b-22e4-49c1-8172-d4e4e8e36697" name="Agrega fila Resultados" type="Action"><loginhibit onsuccess="true" /><display x="315" y="315" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Casos Procesados&quot;" /></inputs><onsuccess>8a8ee67d-809c-4b39-b8d2-011b51d0fc45</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="3e074e43-d731-4b08-b0d6-e4c1d11b80a4" name="Success Proceso" type="Data"><display x="-285" y="285" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="8eaecb2a-18fc-4eee-ac69-be7894095af6" name="Actualizar Log" type="Action"><loginhibit onsuccess="true" /><loginhibitparameters /><display x="90" y="375" /><inputs><input type="collection" name="ColDatos" friendlyname="ColDatos" expr="[Coll a BD]" /><input type="text" name="nombre_tabla" friendlyname="nombre_tabla" expr="&quot;ecw_log_operacional&quot;" /><input type="number" name="identificador" friendlyname="identificador" expr="[Identificador]" /></inputs><outputs><output type="flag" name="Exito insertar Registro" friendlyname="Exito insertar Registro" stage="Exito insertar Registro" /></outputs><onsuccess>2797b62c-2b29-4ea6-bcab-040e89a9bb80</onsuccess><resource object="Utility - Insertar Logs" action="Update Log" /></stage><stage stageid="e64d18b2-41c1-4e12-a375-19a926782b2d" name="Rut" type="Data"><display x="-285" y="105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9da0d685-4cdc-4fe7-aaad-43689ad3dee5" name="Exito insertar Registro" type="Data"><display x="-285" y="180" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f0461371-88ba-4e68-833a-a417a4609d4c" name="Identificador" type="Data"><display x="-225" y="180" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cb924248-8001-4b64-9c0e-fa5f8cdb30a7" name="Resume Actualiza Comisión" type="Resume"><loginhibit /><display x="495" y="210" w="60" h="60" /><onsuccess>eac26a47-534c-40dc-ade7-58307a412ffc</onsuccess></stage><stage stageid="38e3dd59-2408-46c8-a1d8-eaa81155ea31" name="Envío de Resultado" type="SubSheetInfo"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="c3e23da8-55d9-4da6-b2d6-a2a0a8c81a6a" name="Start" type="Start"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-15" y="-90" /><inputs><input type="collection" name="Casos Procesados" stage="Casos Procesados" /></inputs><onsuccess>e37bf610-57e8-4b42-bdad-fce507f55610</onsuccess></stage><stage stageid="86287e7b-9248-4fee-8979-9e92db85cd4e" name="End" type="End"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="90" y="45" /></stage><stage stageid="7c5e019b-3916-48c7-ab7d-4d8baee3a879" name="Procesó?" type="Decision"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-15" y="45" /><decision expression="[Total casos]&gt;0 and ( [Casos Procesados.mailIngresador] &lt;&gt;&quot;--&quot; and [Casos Procesados.mailSolicitante] &lt;&gt;&quot;--&quot; and [Casos Procesados.nroConvenio] &lt;&gt;&quot;--&quot; and [Casos Procesados.rutEmpresa] &lt;&gt;&quot;--&quot;)" /><ontrue>1348c23c-93b9-465c-9797-a107b28b415d</ontrue><onfalse>86287e7b-9248-4fee-8979-9e92db85cd4e</onfalse></stage><stage stageid="93bbb6be-207e-4dd5-8fbc-e50f9925663d" name="Mandar correo log" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="90" y="105" /><inputs><input type="collection" name="Mensaje" friendlyname="Mensaje" expr="[Casos Procesados]" /></inputs><onsuccess>86287e7b-9248-4fee-8979-9e92db85cd4e</onsuccess><resource object="Webbel - Basic Actions" action="Mandar correo log" /></stage><stage stageid="d1d04f15-6a3b-4184-b89e-ea5f63372922" name="Cuenta Casos" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-15" y="0" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Casos Procesados&quot;" /></inputs><outputs><output type="number" name="Count" friendlyname="Count" narrative="The number of rows counted in the collection" stage="Total casos" /></outputs><onsuccess>7c5e019b-3916-48c7-ab7d-4d8baee3a879</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" /></stage><stage stageid="13c2cccd-73cc-492f-8ca3-34440d530e1e" name="Casos Procesados" type="Collection"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-225" y="-15" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="36f450a5-237c-44b6-a12f-39d99e444747" name="Total casos" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-165" y="-15" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c1477a05-f7bc-480a-bb13-5f9b12af446a" name="Input" type="Block"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="-45" w="150" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ed6d28dc-c9d9-48a3-8741-596ee43908f7" name="Post Ok?" type="Decision"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="90" y="225" /><decision expression="[Post ok]" /><ontrue>93bbb6be-207e-4dd5-8fbc-e50f9925663d</ontrue><onfalse>2eb33588-3a3c-41b4-a5c7-df679bd01a28</onfalse></stage><stage stageid="1348c23c-93b9-465c-9797-a107b28b415d" name="Google Launch" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-15" y="90" /><onsuccess>8363f388-c2a3-4a12-ac11-3839b85820b1</onsuccess><resource object="Chrome - Google Account Login extensión" action="Launch" /></stage><stage stageid="8363f388-c2a3-4a12-ac11-3839b85820b1" name="Google Login" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-15" y="135" /><inputs><input type="text" name="Usuario" friendlyname="Usuario" narrative="Nombre del usuario a ingresar al aplicativo." expr="[Username]" /><input type="password" name="Clave" friendlyname="Clave" narrative="Clave del usuario a ingresar al aplicativo." expr="[Password]" /></inputs><onsuccess>74d96605-945c-486f-806a-ef496e5c0e1f</onsuccess><resource object="Chrome - Google Account Login extensión" action="Login" /></stage><stage stageid="509b4dd7-8dc5-40e0-8af1-40b11b4d8804" name="url" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="60" /><datatype>text</datatype><initialvalue xml:space="preserve">https://script.google.com/a/bci.cl/macros/s/AKfycbzHOz8BwtSAa8-i0lmmIQtiiVeNbb4Ng8Vf7TG1yB4UjnMM6Dc/exec?servicio=actualizarEstado&amp;</initialvalue><private /><alwaysinit /></stage><stage stageid="3ba6410f-cef7-416c-afe1-7d72d8889d80" name="Username" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="180" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="473dee05-4b16-4afb-9082-1e732d6dd899" name="Password" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-165" y="180" /><datatype>password</datatype><initialvalueenc>2,26,70,0,95,4,21,7,51</initialvalueenc><private /><alwaysinit /></stage><stage stageid="b1a06e7a-c99e-4d37-8503-caf4c9db80f5" name="Post ok" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-135" y="105" w="30" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e37bf610-57e8-4b42-bdad-fce507f55610" name="Get Credentials" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit /><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><display x="-15" y="-45" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials to get" expr="&quot;GLOBAL_GMAIL_ENVIO-CORREO&quot;" /></inputs><outputs><output type="password" name="Password" narrative="The password" stage="Password" /><output type="text" name="Username" narrative="The user name" stage="Username" /><output type="date" name="Expiry Date" narrative="The expiry date" stage="Expiry Date" /><output type="text" name="Status" narrative="The status" stage="Status" /></outputs><onsuccess>d1d04f15-6a3b-4184-b89e-ea5f63372922</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="810b33c1-2ed7-4351-a940-5307b4ea5565" name="Expiry Date" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-165" y="225" /><datatype>date</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="05585290-97c0-48c8-ae09-6b62a8e39216" name="Status" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-225" y="225" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="32c3c024-8e96-4a35-8862-18a4c7668652" name="Recover Envío Resultado" type="Recover"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit /><display x="90" y="-165" /><onsuccess>36c2aae2-c5bd-4467-a587-0cb0f1287f9b</onsuccess></stage><stage stageid="6198b205-49c3-4226-b9ad-bc0762cd5dc3" name="Resume Envío Resultado" type="Resume"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit /><display x="90" y="-75" /><onsuccess>bd7e3cb3-a507-4233-899a-4206bbd46981</onsuccess></stage><stage stageid="36c2aae2-c5bd-4467-a587-0cb0f1287f9b" name="Excepciones Sheet" type="MultipleCalculation"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="90" y="-120" /><onsuccess>6198b205-49c3-4226-b9ad-bc0762cd5dc3</onsuccess><steps><calculation expression="ExceptionType()" stage="ExceptionType" /><calculation expression="ExceptionStage()" stage="ExceptionStage" /><calculation expression="ExceptionDetail()" stage="ExceptionDetail" /></steps></stage><stage stageid="b00210ca-5b33-4391-848a-eda5970269a4" name="ExceptionType" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-165" y="300" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="061b2bd4-ece8-4857-84f5-a0bfddb8a851" name="ExceptionStage" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-210" y="330" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b7fe2487-c9a5-45be-97a5-aa15d2ff5785" name="ExceptionDetail" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="-240" y="300" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="73bcfc69-bd6a-4e2c-b66d-e0790eb9780e" name="VARIABLE EXCEPCIONES" type="Block"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="270" w="150" h="75" /><font family="Segoe UI" size="10" style="Regular" color="FF0000" /></stage><stage stageid="6c45b7f7-26b4-4b14-a83c-ce0038ca2f3c" name="CREDENCIALES" type="Block"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="150" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="FFFF00" /></stage><stage stageid="cdd68151-a3f3-4487-9002-4f1c271386c7" name="Variables Locales" type="Block"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="30" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="C0C0C0" /></stage><stage stageid="6b703d9b-b20e-4e79-abb0-751e0b3f3c41" name="Recover Lectura" type="Recover"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit /><display x="120" y="60" /><onsuccess>dd29721e-9cd7-45f7-9238-a2b6b9f41395</onsuccess></stage><stage stageid="fa388dc4-65d6-4b5c-8c0a-c05b484dcf6c" name="Resume Lectura" type="Resume"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit /><display x="120" y="195" /><onsuccess>6b2ec424-3dea-4943-9820-101739f89bc2</onsuccess></stage><stage stageid="dd29721e-9cd7-45f7-9238-a2b6b9f41395" name="Captura Exception" type="MultipleCalculation"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="120" y="120" /><onsuccess>fa388dc4-65d6-4b5c-8c0a-c05b484dcf6c</onsuccess><steps><calculation expression="ExceptionType()" stage="ExceptionType" /><calculation expression="ExceptionDetail()" stage="ExceptionDetail" /><calculation expression="ExceptionStage()" stage="ExceptionStage" /><calculation expression="False" stage="Success Sheet" /></steps></stage><stage stageid="2a3e38be-9e0a-4037-b4c0-eec4c9c24aa8" name="ExceptionStage" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-240" y="315" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c5123de2-426d-400c-83d4-3e5ad523040c" name="ExceptionDetail" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-180" y="315" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2d1ce3b0-a503-4b81-8a62-f04557c6711f" name="ExceptionType" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-120" y="315" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a3828afc-9762-409c-8b73-0ce89fbcccf9" name="VARIABLE EXCEPCIONES" type="Block"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="270" w="180" h="75" /><font family="Segoe UI" size="10" style="Regular" color="FF0000" /></stage><stage stageid="702e5b44-6d1c-4b49-a087-67e2ba0f2568" name="CREDENCIALES" type="Block"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="-15" w="165" h="105" /><font family="Segoe UI" size="10" style="Regular" color="FFFF00" /></stage><stage stageid="cf9ae26f-2df6-4887-9e61-220834f86a2d" name="Expiry Date" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-150" y="15" /><datatype>date</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c39bd261-9841-429c-b89b-79ce269a26c8" name="Status" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-150" y="60" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3178a49c-1da3-48c1-9fc7-e0e0c6dfdc00" name="Input" type="Collection"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-150" y="180" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="bd9306b2-2e61-421e-b69d-96a9bb7e277a" name="Hora Inicio" type="Calculation"><loginhibit onsuccess="true" /><display x="90" y="210" w="30" h="30" /><onsuccess>cc25a7bb-c845-4610-8fdb-d905d01b680b</onsuccess><calculation expression="FormatDateTime(Today(), &quot;yyyy/MM/dd&quot;)&amp;&quot; &quot;&amp;LocalTime()" stage="Inicio" /></stage><stage stageid="adc36858-b5bc-423e-8e0c-fee34499c1ed" name="Hora Fin" type="Calculation"><loginhibit onsuccess="true" /><display x="315" y="270" w="30" h="30" /><onsuccess>9bead92b-22e4-49c1-8172-d4e4e8e36697</onsuccess><calculation expression="FormatDateTime(Today(), &quot;yyyy-MM-dd&quot;)&amp;&quot; &quot;&amp;LocalTime()" stage="Fin" /></stage><stage stageid="af816a72-063a-401d-a8ca-f63220446de0" name="Fin" type="Data"><display x="-225" y="210" w="30" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f6f2f169-8abb-43c6-8f6a-16b148804923" name="Inicio" type="Data"><display x="-255" y="210" w="30" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="097043c9-0277-4c96-aecf-2d282a334fb0" name="Coll a BD" type="Collection"><display x="-300" y="210" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="fecha_inicio" type="text" /><field name="fecha_termino" type="text" /><field name="status" type="text" /><field name="mensaje" type="text" /></collectioninfo></stage><stage stageid="d50e5cfc-8d88-4a8d-96b5-f364c2bb1154" name="VARIABLES DE LOOP" type="Block"><loginhibit onsuccess="true" /><display x="-390" y="150" w="255" h="90" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="6b9f4de3-37b0-44d7-82f3-e0145ddfacf1" name="url nueva" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="-225" y="135" /><datatype>text</datatype><initialvalue xml:space="preserve">https://script.google.com/a/bci.cl/macros/s/AKfycbxLKIz-ypMnKVERaV2SejZCqa412Bk5njSkd396_XouNnxwZ8dj/exec?modo=readSheet</initialvalue><private /><alwaysinit /></stage><stage stageid="3d8382f6-3d75-48f3-80f8-5d25cd9eb708" name="Collections::Agrega fila Log BD" type="Action"><loginhibit onsuccess="true" /><display x="-45" y="210" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Coll a BD&quot;" /></inputs><onsuccess>e4851def-080f-4ce9-acc2-eff517aaab02</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="38df0683-09a4-4cb7-9a7a-49fde08d8d0c" name="Insertar Log" type="Action"><loginhibit onsuccess="true" /><display x="225" y="210" /><inputs><input type="collection" name="ColDatos" friendlyname="ColDatos" expr="[Coll a BD]" /><input type="text" name="nombre_tabla" friendlyname="nombre_tabla" expr="&quot;ecw_log_operacional&quot;" /></inputs><outputs><output type="flag" name="Exito insertar Registro" friendlyname="Exito insertar Registro" stage="Exito insertar Registro" /><output type="number" name="Identificador" friendlyname="Identificador" stage="Identificador" /></outputs><onsuccess>bc4e43fb-bb81-424d-b6cf-240fdf817985</onsuccess><resource object="Utility - Insertar Logs" action="Insertar Log" /></stage><stage stageid="cc25a7bb-c845-4610-8fdb-d905d01b680b" name="Set valores Log" type="MultipleCalculation"><loginhibit onsuccess="true" /><display x="150" y="210" /><onsuccess>38df0683-09a4-4cb7-9a7a-49fde08d8d0c</onsuccess><steps><calculation expression="[Inicio]" stage="Coll a BD.fecha_inicio" /><calculation expression="&quot;&quot;" stage="Coll a BD.mensaje" /><calculation expression="&quot;In Progress&quot;" stage="Coll a BD.status" /></steps></stage><stage stageid="7167025b-88cf-45fb-8166-8b8085267d5d" name="Cuenta Casos" type="Action"><loginhibit onsuccess="true" /><display x="-60" y="-210" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Casos&quot;" /></inputs><outputs><output type="number" name="Count" friendlyname="Count" narrative="The number of rows counted in the collection" stage="Total casos" /></outputs><onsuccess>c830210a-c2d8-4f4e-904f-baa4c8a216c4</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" /></stage><stage stageid="2797b62c-2b29-4ea6-bcab-040e89a9bb80" name="Limpia Coll Log " type="Action"><loginhibit onsuccess="true" /><display x="15" y="375" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Coll a BD&quot;" /></inputs><onsuccess>d7507cea-0715-47b8-9d9a-f06a43a0ac6e</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="584253a3-38fa-4587-888c-29e293013114" name="Mensaje" type="Data"><loginhibit onsuccess="true" /><display x="-270" y="345" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="ff26e702-f4dd-4d08-9c53-3c025a1587fa" name="Recover General" type="Recover"><loginhibit /><display x="315" y="435" /><onsuccess>12c95325-83aa-4ff6-9393-18b6a18d5bbb</onsuccess></stage><stage stageid="5586364b-b6c5-454a-a189-c3be91d8e8fa" name="Resume General" type="Resume"><loginhibit /><display x="315" y="525" /><onsuccess>063d1c36-5c2f-4bcf-9174-45357c43fa43</onsuccess></stage><stage stageid="12c95325-83aa-4ff6-9393-18b6a18d5bbb" name="Captura Exception Gral" type="MultipleCalculation"><loginhibit onsuccess="true" /><display x="315" y="480" /><onsuccess>5586364b-b6c5-454a-a189-c3be91d8e8fa</onsuccess><breakpoint type="0"><condition></condition></breakpoint><steps><calculation expression="ExceptionType()" stage="ExceptionType" /><calculation expression="ExceptionStage()" stage="ExceptionStage" /><calculation expression="ExceptionDetail()" stage="ExceptionDetail" /></steps></stage><stage stageid="17442797-08c7-4e04-9c08-8a9743bbaaec" name="ExceptionDetail" type="Data"><display x="-300" y="390" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="523be259-e43f-4960-a71f-dd81bf17de47" name="ExceptionStage" type="Data"><display x="-210" y="390" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6d9d9462-298d-4e7e-b26d-93d20095958d" name="ExceptionType" type="Data"><display x="-255" y="390" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="716ecc12-c379-4840-90a9-5967f4634fb6" name="url nueva" type="Data"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-150" y="60" /><datatype>text</datatype><initialvalue xml:space="preserve">https://script.google.com/a/bci.cl/macros/s/AKfycbxLKIz-ypMnKVERaV2SejZCqa412Bk5njSkd396_XouNnxwZ8dj/exec?modo=writeSheet&amp;</initialvalue><private /><alwaysinit /></stage><stage stageid="74d96605-945c-486f-806a-ef496e5c0e1f" name="Post JSON" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-15" y="180" /><inputs><input type="collection" name="Input" friendlyname="Input" expr="[Casos Procesados]" /><input type="text" name="url" friendlyname="url" expr="[url]" /></inputs><outputs><output type="flag" name="Post ok" friendlyname="Post ok" stage="Post ok" /></outputs><onsuccess>d2c3913d-a35f-4651-94ad-3a9e54669449</onsuccess><resource object="Webbel - Service Rest extensión" action="POST Service REST" /></stage><stage stageid="8a8ee67d-809c-4b39-b8d2-011b51d0fc45" name="Procesado?" type="Decision"><display x="315" y="375" /><decision expression="[Success Proceso]" /><ontrue>1f8222a7-d39a-45c8-82e8-c3657464ffc0</ontrue><onfalse>9f95a537-f759-4f33-b2f7-52c6dfb3a039</onfalse></stage><stage stageid="5803b620-71ca-413f-8e84-ddecd35539e5" name="Variable Estado para Sheet" type="Data"><display x="-345" y="180" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c975715a-193d-4b4e-9e3e-a9bf6e25b9f2" name="Exception Escritura de resultados" type="Exception"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><display x="330" y="225" /><exception localized="yes" type="System Exception" detail="&quot;Exception Escritura de resultados&quot;" /></stage><stage stageid="1f8222a7-d39a-45c8-82e8-c3657464ffc0" name="Procesado OK" type="MultipleCalculation"><loginhibit onsuccess="true" /><display x="240" y="360" /><onsuccess>464bfd7d-794d-462f-96ba-fe302b3c5fca</onsuccess><steps><calculation expression="&quot;OK&quot;" stage="Variable Estado para Sheet" /><calculation expression="&quot;procesado&quot;" stage="Mensaje" /><calculation expression="[Contador Proceso Exitosos]+1" stage="Contador Proceso Exitosos" /></steps></stage><stage stageid="9f95a537-f759-4f33-b2f7-52c6dfb3a039" name="Procesado NOK" type="MultipleCalculation"><loginhibit onsuccess="true" /><display x="240" y="405" /><onsuccess>464bfd7d-794d-462f-96ba-fe302b3c5fca</onsuccess><steps><calculation expression="&quot;NO OK&quot;" stage="Variable Estado para Sheet" /><calculation expression="&quot;procesado con errores&quot;" stage="Mensaje" /><calculation expression="[Contador Proceso Fallidos]+1" stage="Contador Proceso Fallidos" /></steps></stage><stage stageid="d2c3913d-a35f-4651-94ad-3a9e54669449" name="Google Cerrar Pestaña" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="-15" y="225" /><onsuccess>ed6d28dc-c9d9-48a3-8741-596ee43908f7</onsuccess><resource object="Chrome - Google Account Login extensión" action="Cierre Pestaña" /></stage><stage stageid="33532558-e5d4-42d5-aa3d-a002d850c333" name="Chrome Cierre Pestaña" type="Action"><loginhibit onsuccess="true" /><display x="-60" y="510" /><onsuccess>93ca3970-49d9-4b77-8910-f227cff1126b</onsuccess><resource object="Webbel - Basic Actions" action="Cierre Pestaña" /></stage><stage stageid="624d063e-5f97-401f-b3cb-62cc9571ecb6" name="Channel" type="Data"><display x="-225" y="510" /><datatype>text</datatype><initialvalue xml:space="preserve">#monitoreo</initialvalue><alwaysinit /></stage><stage stageid="6908259e-d525-4a70-90de-96c28fc49c82" name="Text" type="Data"><display x="-225" y="465" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="652dfd4a-6df4-43cd-8716-9064947261c9" name="Fallback" type="Data"><display x="-300" y="555" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="6b40e22e-e57d-4e3f-afc9-3e76c2423acc" name="Colour" type="Data"><display x="-300" y="510" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="16dfb885-ab65-48bb-8526-999193ffecfc" name="Tittle" type="Data"><display x="-300" y="465" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="1be8b751-7229-4a91-9570-ab663d92e535" name="Slack Bearer Token" type="Data"><display x="-225" y="555" w="90" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">SLACK</initialvalue><private /><alwaysinit /></stage><stage stageid="532e1f5b-2bd7-4694-adbf-000699678eb8" name="Image URL" type="Data"><display x="-300" y="600" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="714ced0d-4e4b-46c1-9ab1-017ef0f64348" name="Footer" type="Data"><display x="-210" y="600" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bc4fdb47-4702-4a15-8791-bfe9527c7d8d" name="SLACK" type="Block"><loginhibit onsuccess="true" /><display x="-345" y="435" w="195" h="255" /><font family="Segoe UI" size="10" style="Regular" color="FF6600" /></stage><stage stageid="1303d9b8-6a66-43eb-a52e-9bdd8231aba0" name="Response Content" type="Data"><display x="-300" y="675" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="9d0f6094-9383-49a8-825f-7421ff26cf63" name="HTTP Status Code" type="Data"><display x="-300" y="630" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="da964b12-2358-437b-a0c0-6d2243a1810e" name="Response Headers" type="Collection"><display x="-210" y="660" /><datatype>collection</datatype><alwaysinit /></stage><stage stageid="1971c482-fb30-4eda-afd6-6ee293ecf4f5" name="Success" type="Data"><display x="-210" y="630" /><datatype>flag</datatype><initialvalue /><alwaysinit /></stage><stage stageid="548646e7-2b5d-4d68-842d-18fbeef893c0" name="Contador Proceso Exitosos" type="Data"><display x="-165" y="180" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="05df941b-a42e-45bb-b9f6-27ef2a885528" name="Contador Proceso Fallidos" type="Data"><display x="-180" y="225" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="30409a61-3d74-41ca-8737-8d4b786cb91d" name="Slack::Notificar:INICIO PROCESO" type="Action"><loginhibit onsuccess="true" /><display x="-60" y="-465" w="120" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#procesos&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Inició proceso&quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Se Da Inicio a Ejecución de Proceso Actualiza Comisiones Servicios(Refactor PNOL)&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>a9685480-b0e9-4e28-a933-df9bcaa1246d</onsuccess><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="35d38a84-eaf7-4dba-b094-f0b46c227814" name="Slack::Notificar:FIN DE PROCESO" type="Action"><loginhibit onsuccess="true" /><display x="180" y="-165" w="150" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#procesos&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Finalizó proceso ACTUALIZA COMISION PNOL&quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Finaliza la Ejecución de Proceso Actualiza Comisiones Servicios(Refactor PNOL). No Hay Registros Por Procesar&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>53e67bbf-b592-4c8a-b996-ce9c4c695c3d</onsuccess><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="eac26a47-534c-40dc-ade7-58307a412ffc" name="Slack::Notificar_Problemas Actualiza Comision" type="Action"><loginhibit onsuccess="true" /><display x="615" y="210" w="120" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#monitoreo&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Error Actualiza comision :( &quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Error Actualiza comision para Rut :&quot;&amp;[Casos.rutEmpresa]&amp;&quot; Numero Convenio: &quot;&amp;[Casos.nroConvenio]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>699f1dfa-bec4-4728-8ac7-197fc6dc7ec3</onsuccess><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="063d1c36-5c2f-4bcf-9174-45357c43fa43" name="Slack::Notificar_Problema Inesperado" type="Action"><loginhibit onsuccess="true" /><display x="165" y="525" w="120" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="[Channel]" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Error Inesperado ACTUALIZA COMISION PNOL :( &quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Error inesperado, favor comunicarse con: coerpa@bci.cl para que lo intenemos nuevamente&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>8f5f3d35-0241-4893-890d-d28674ddf6f1</onsuccess><breakpoint type="0"><condition></condition></breakpoint><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="a2abc84b-1081-444d-a0fc-c43635eba191" name="Slack::Notificar_Finalizó Proceso" type="Action"><loginhibit onsuccess="true" /><display x="-60" y="630" w="120" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#procesos&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Termina Proceso &quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Finaliza Proceso Actualiza Comisión de un total de Casos de : &quot;&amp;[Total casos]&amp;&quot; Se procesaron exitosamente: &quot;&amp;[Contador Proceso Exitosos]&amp;&quot; Y Fallidos: &quot;&amp;[Contador Proceso Fallidos]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>60f867f5-6461-45ff-92ee-83cbf638d400</onsuccess><breakpoint type="0"><condition></condition></breakpoint><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="2eb33588-3a3c-41b4-a5c7-df679bd01a28" name="Slack::Notificar_Problema Escritura en Sheet" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="195" y="225" w="120" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#monitoreo&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Error Escritura Gogle Sheet :( &quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Error Escritura Google Sheet, favor comunicarse con: coerpa@bci.cl para que lo intenemos nuevamente&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>c975715a-193d-4b4e-9e3e-a9bf6e25b9f2</onsuccess><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="bd7e3cb3-a507-4233-899a-4206bbd46981" name="Slack::Notificar_Problema Inesperado" type="Action"><subsheetid>f094c90e-f9d1-443e-8259-86680cc9b2ab</subsheetid><loginhibit onsuccess="true" /><display x="90" y="-15" w="120" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#monitoreo&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Error Inesperado :( &quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Error inesperado, favor comunicarse con: coerpa@bci.cl para que lo intenemos nuevamente&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>86287e7b-9248-4fee-8979-9e92db85cd4e</onsuccess><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="c7206f24-3def-42ae-9c8d-094f2b3825d4" name="Success Sheet" type="Data"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><display x="-150" y="225" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="da499b08-adc3-4ec2-8e2a-7eff363c0b86" name="Success Extract" type="Calculation"><subsheetid>49162dbf-68b6-42e8-bd44-dcc510422003</subsheetid><loginhibit onsuccess="true" /><display x="15" y="240" /><onsuccess>6b2ec424-3dea-4943-9820-101739f89bc2</onsuccess><calculation expression="True" stage="Success Sheet" /></stage><stage stageid="822b3d24-84e0-410f-852b-bd1fab53e99c" name="Success Sheet" type="Data"><display x="-195" y="315" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="844742ee-6e27-44f9-8dd4-cc1ae1065496" name="Success Sheet?" type="Decision"><display x="-60" y="-270" /><decision expression="[Success Sheet]" /><ontrue>7167025b-88cf-45fb-8166-8b8085267d5d</ontrue><onfalse>e88e640e-a3a2-41c2-8242-5c45b71aca30</onfalse></stage><stage stageid="36a25bd4-624a-4950-932e-f8a82b30bada" name="Cuenta Login" type="Data"><loginhibit onsuccess="true" /><display x="-180" y="285" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="e88e640e-a3a2-41c2-8242-5c45b71aca30" name="Reintentar Login?" type="Decision"><display x="75" y="-270" /><decision expression="[Cuenta Login]&lt;4" /><ontrue>4ca1943d-314a-4bb9-ac99-1f00bf49300d</ontrue><onfalse>b61c971f-afe2-4d1f-8e7c-73771f0b0714</onfalse></stage><stage stageid="4ca1943d-314a-4bb9-ac99-1f00bf49300d" name="Aumenta Cuenta Login" type="Calculation"><loginhibit onsuccess="true" /><display x="75" y="-375" /><onsuccess>a9685480-b0e9-4e28-a933-df9bcaa1246d</onsuccess><calculation expression="[Cuenta Login]+1" stage="Cuenta Login" /></stage><stage stageid="b61c971f-afe2-4d1f-8e7c-73771f0b0714" name="Slack::Notificar ERROR CON SHEET LECTURA" type="Action"><loginhibit onsuccess="true" /><display x="240" y="-270" w="150" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#monitoreo&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Error Chrome  ACTUALIZA COMISION PNOL:(&quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Lamentablemente Chrome Presenta Problemas, favor comunicarse con: coerpa@bci.cl para que lo intenemos nuevamente&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>8942823a-f95a-4565-a868-d994a2079232</onsuccess><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="941018d3-5fa2-4ab2-a4b4-f9bd71df797e" name="Extracción Casos Sheet" type="Block"><loginhibit onsuccess="true" /><display x="-150" y="-420" w="645" h="180" /><font family="Segoe UI" size="10" style="Regular" color="800000" /></stage><stage stageid="afde3373-5daf-45a4-9e37-2d44e0d623b4" name="Slack::Notificar_Problemas Webbel" type="Action"><loginhibit onsuccess="true" /><display x="60" y="60" w="120" h="60" /><inputs><input type="text" name="Channel" friendlyname="Channel" narrative="Canal de difusión" expr="&quot;#monitoreo&quot;" /><input type="text" name="Tittle" friendlyname="Tittle" narrative="Titulo del mensaje" expr="&quot;Error Webbel :(&quot;" /><input type="text" name="Text" friendlyname="Text" narrative="Mensaje" expr="&quot;Lamentablemente Webbel Presenta Problemas, favor comunicarse con: coerpa@bci.cl para que lo intenemos nuevamente&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag de salida" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Mensaje de ejecución" stage="Mensaje" /></outputs><onsuccess>fc1a77c8-553c-45ba-9383-fece848dea22</onsuccess><breakpoint type="0"><condition></condition></breakpoint><resource object="Utility - Slack" action="Notificar" /></stage><stage stageid="8942823a-f95a-4565-a868-d994a2079232" name="Exception Leer Input" type="Exception"><display x="405" y="-270" /><exception localized="yes" type="System Exception" detail="&quot;Error al leer el input de entrada&quot;" /></stage><stage stageid="8f5f3d35-0241-4893-890d-d28674ddf6f1" name="Pestaña abierta?" type="Decision"><display x="45" y="525" /><decision expression="[Success Sheet]" /><ontrue>33532558-e5d4-42d5-aa3d-a002d850c333</ontrue><onfalse>93ca3970-49d9-4b77-8910-f227cff1126b</onfalse></stage></process></process>
        <object id="1b13f5b8-01d1-441e-bd7f-54884a24d71f" name="Utility - Strings" xmlns="http://www.blueprism.co.uk/product/process"><process name="Utility - Strings" version="6.2.0.2669" bpversion="6.9.0.26970" narrative="Utility functions for manipulating text." byrefcollection="true" type="object" runmode="Background"><appdef><element name="Application Root"><id>b30f5d67-5c3c-49c9-8f9b-66d573097498</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>60</camerax><cameray>-35</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="9a74af4c-280a-4e30-bdbb-21295b6256ca" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="65117a41-f7ff-4f3f-abd1-7a3cbe18cfda" type="Normal" published="True"><name>Remove Non-word Characters</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d8fea7a8-24d9-41c8-9397-a3839e6ffdc1" type="Normal" published="True"><name>Generate New GUID</name><view><camerax>0</camerax><cameray>-84</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e70e8f13-02df-4b14-bb74-6fd5c4c95928" type="Normal" published="True"><name>Delete Characters</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="6a710d42-8f41-45d0-9e74-1eddf74c0e75" type="Normal" published="True"><name>Split Lines by Length</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e6bab90c-ddfd-48c0-af38-804fe4f770ed" type="Normal" published="True"><name>Split Lines</name><view><camerax>0</camerax><cameray>-6</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a5871062-5ad2-4950-afbc-cb5b1b7a7f0b" type="Normal" published="True"><name>Split Text</name><view><camerax>0</camerax><cameray>-56</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a2c09338-7850-4daf-a545-8972d333b826" type="Normal" published="True"><name>Join Text</name><view><camerax>65</camerax><cameray>75</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a854bb6a-4399-4e51-8fc3-64f9e1d4f896" type="Normal" published="True"><name>Join Lines</name><view><camerax>152</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="fcddf4bf-83af-4431-88db-cc2c88390cec" type="Normal" published="True"><name>Get Newline Character</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="06780f7c-9622-4d84-9db3-bb56a2ff9f36" type="Normal" published="True"><name>Extract Regex Values</name><view><camerax>70</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a6b6398e-c21a-4c4e-9742-65ccad8370d9" type="Normal" published="True"><name>Test Regex Match</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5110b353-010b-4874-97bd-8b7621c24384" type="Normal" published="True"><name>Format Number</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ef8de52d-842b-45f0-8f1b-619bc97d4bbc" type="Normal" published="True"><name>PadLeft</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="818441a5-ffec-4841-b0ea-00712caf63aa" type="Normal" published="True"><name>Get XML Elements</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e8af11f7-dfd4-4c86-9935-e83828b9e711" type="Normal" published="True"><name>Get XML Attribute</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f9add4d4-31de-4c0f-a109-0b51fa576a23" type="Normal" published="True"><name>Get Collection as CSV</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f5b26213-5463-4b2d-b10f-b188876b436f" type="Normal" published="True"><name>Get CSV As Collection</name><view><camerax>248</camerax><cameray>-87</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="040cc29a-27ac-402c-8a66-328554dd4bc0" type="Normal" published="True"><name>Escape Sendkeys String</name><view><camerax>0</camerax><cameray>5</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="527ca986-a03f-4231-880e-5b1c244b035e" type="Normal" published="True"><name>Compare Font Text</name><view><camerax>150</camerax><cameray>27</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="0244396a-1d3d-4892-b6cb-461468f4c7e1" type="Normal" published="True"><name>InStr</name><view><camerax>0</camerax><cameray>-2</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9ab28c01-86eb-458d-b8d9-74f98926d266" type="Normal" published="True"><name>InStrRev</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="d8c547cc-60d0-459b-876f-90bf696a5757" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>807e7d33-91e2-4241-a85e-ea0718fc487d</onsuccess></stage><stage stageid="807e7d33-91e2-4241-a85e-ea0718fc487d" name="End" type="End"><loginhibit /><display x="15" y="90" /></stage><stage stageid="1a8c9ebd-54e1-442f-a6c7-e87df3b59232" name="Stage1" type="ProcessInfo"><display x="-195" y="-105" w="150" h="90" /><references><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import><import>System.IO</import><import>System.XML</import><import>System.Diagnostics</import><import>Microsoft.VisualBasic</import><import>System.Data</import><import>system.text.regularexpressions</import><import>System.Text</import><import>System.Collections.Generic</import><import>Microsoft.VisualBasic.FileIO</import></imports><language>visualbasic</language><globalcode><![CDATA[


]]></globalcode><code><![CDATA[Public Function GetDataTable(ByVal ColumnNamesCSV As String, ByVal ColumnTypesCSV As String) As DataTable

	Dim objTable As DataTable
	Dim objColumn As DataColumn
	Dim aColumnNames As String() = ColumnNamesCSV.Split(",")
	Dim aColumnTypes As String() = ColumnTypesCSV.Split(",")

	Try
		objTable = New DataTable
		For i As Integer = 0 To aColumnNames.Length - 1
			objColumn = New DataColumn 
			objColumn.DataType = System.Type.GetType(aColumnTypes(i).Trim)
			objColumn.ColumnName = aColumnNames(i).Trim
			objTable.Columns.Add(objColumn)
		Next
		
	Catch e As Exception
		objTable = nothing	
	End Try

	Return objTable

End Function

Private Function SplitStringInto( _
 ByVal fldName As String, _
 ByVal txt As String, _
 ByVal ParamArray splitters() As String) As DataTable
	Dim dt As New DataTable()
	dt.Columns.Add(fldName, GetType(String))

	For Each s As String In txt.Split(splitters, StringSplitOptions.None)
		dt.Rows.Add(New Object() {s})
	Next

	Return dt
End Function

Public Shared Function ParseCsvToList(ByVal csv As String) As List(Of String())
	Dim result = New List(Of String())()

	Using sr As New StringReader(csv)
		Using lineParser As New TextFieldParser(sr)
			lineParser.TextFieldType = FieldType.Delimited
			lineParser.SetDelimiters(",")
			While Not lineParser.EndOfData

				Dim fields As String() = lineParser.ReadFields()
				result.Add(fields)
			End While
		End Using
	End Using

	Return result
End Function


''' -----------------------------------------------------------------------------
''' <summary>
''' Serialises a datatable to the supplied stream.
''' </summary>
''' <param name="Writer">The stream writr to which the datatable should
''' be serialised. Eg this may correspond to a file stream.</param>
''' <param name="Table">The datatable to be serialised.</param>
''' <param name="IncludeHeaderRow">When true, the column headers will
''' be wrtten out on the first row.</param>
''' -----------------------------------------------------------------------------
Public Shared Sub WriteDataTable(ByVal Writer As StringBuilder, ByVal Table As DataTable, ByVal IncludeHeaderRow As Boolean)
	If IncludeHeaderRow Then
		For i As Integer = 0 To Table.Columns.Count - 1
			WriteItem(Writer, Table.Columns(i).ColumnName)
			If i < Table.Columns.Count - 1 Then
				Writer.Append(",")
			Else
				Writer.Append(vbCrLf)
			End If
		Next
	End If

	For Each Row As DataRow In Table.Rows
		For i As Integer = 0 To Table.Columns.Count - 1
			WriteItem(Writer, Row(i).ToString)
			If i < Table.Columns.Count - 1 Then
				Writer.Append(",")
			Else
				Writer.Append(vbCrLf)
			End If
		Next
	Next
End Sub



''' -----------------------------------------------------------------------------
''' <summary>
''' Writes a csv data cell, escaping quotes and new lines where necessary.
''' </summary>
''' <param name="Writer">The writer to which the item should be written.</param>
''' <param name="Value">The value to be written.</param>
''' -----------------------------------------------------------------------------
Private Shared Sub WriteItem(ByVal Writer As StringBuilder, ByVal Value As String)
	If Value.IndexOfAny(("""," & vbCrLf).ToCharArray) > -1 Then
		Writer.Append("""" & Value.Replace("""", """""") & """")
	Else
		Writer.Append(Value)
	End If
End Sub


'Splits text into lines of approximately equal length, looking for
'gaps between words as splitting points in order to avoid ugly
'line splitting in the middle of words. Useful for mainframe memos
'where a long message needs to be broken into lines of up to 80
'characters.
'
Private Shared Function SplitTextByLengthEngine(Texttosplit As String, MaxLineLength As Integer) As List(of String)
	Dim RetVal as New List(Of String)
	MaxLineLength =  Math.Min(MaxLineLength, TexttoSplit.Length)

	'We look for the last space within (MaxLineLength + 1) and then work backwards
	'(always by at least one) to find the last non-space character. We can then
	'chop at this point, assuming such exists. Otherwise we just chop at the
	'requested line length accepting we will be splitting a word.
	Dim LastIndex as integer = TexttoSplit.Substring(0, Math.Min(MaxLineLength + 1, TextToSplit.Length)).LastIndexOf(" ")

	If TextToSplit.Length <= MaxLineLength OrElse LastIndex = -1 Then
		RetVal.Add(TexttoSplit.Substring(0, MaxLineLength))
		Dim RemainingText As String = TexttoSplit.SubString(MaxLineLength,TextToSplit.Length - MaxLineLength).Trim()
		If RemainingText.Length > 0 Then RetVal.AddRange(SplitTextByLengthEngine(RemainingText, MaxLineLength))
	Else
		'Track backwards to find previous non-space character
		Dim Index As Integer = LastIndex - 1
		While Index >= 0 Andalso TextToSplit.SubString(Index, 1) = " "
			Index -=1
		End While
		If Index >= 0 Then
			RetVal.Add(TextToSplit.SubString(0, Index + 1))
			Dim RemainingText As String = TexttoSplit.SubString(Index + 1, TextToSplit.Length - (Index + 1)).Trim()
			If RemainingText.Length > 0 Then RetVal.AddRange(SplitTextByLengthEngine(RemainingText, MaxLineLength))
		Else
			'Must all be spaces. We assume this are to be ignored
		End If
	End If

	Return RetVal
End Function

]]></code></stage><stage stageid="0bf7814a-647b-4bcb-b6a6-3d24dfd5b736" name="Clean Up" type="SubSheetInfo"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="b6df3b6c-090d-4126-a16c-8caa889b0646" name="Generate New GUID" type="SubSheetInfo"><subsheetid>d8fea7a8-24d9-41c8-9397-a3839e6ffdc1</subsheetid><narrative>Generates a new globally unique identifier as text.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="0c56e2f8-68ce-48a3-97ad-81e1f076e9ce" name="new" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="be35a29d-2b71-42e1-9ca7-4534046d5dfc" name="Start" type="Start"><subsheetid>d8fea7a8-24d9-41c8-9397-a3839e6ffdc1</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>bd80e756-d12c-4dc7-9d64-bbde733f60b7</onsuccess></stage><stage stageid="bd80e756-d12c-4dc7-9d64-bbde733f60b7" name="Get GUID" type="Code"><subsheetid>d8fea7a8-24d9-41c8-9397-a3839e6ffdc1</subsheetid><loginhibit /><display x="15" y="-45" /><outputs><output type="text" name="id" stage="GUID" /></outputs><onsuccess>4930704e-00c1-456a-8aad-02220fd81c99</onsuccess><code><![CDATA[dim g as new Guid
id = guid.newguid.tostring]]></code></stage><stage stageid="695dad7d-b634-454c-9171-baf489698067" name="GUID" type="Data"><subsheetid>d8fea7a8-24d9-41c8-9397-a3839e6ffdc1</subsheetid><display x="-60" y="-45" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4930704e-00c1-456a-8aad-02220fd81c99" name="End1" type="End"><subsheetid>d8fea7a8-24d9-41c8-9397-a3839e6ffdc1</subsheetid><loginhibit /><display x="15" y="15" /><outputs><output type="text" name="GUID" narrative="The new guid" stage="GUID" /></outputs></stage><stage stageid="2271a79e-27e5-4434-b5be-146e02946317" name="new" type="Note"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="36451c72-b274-4817-a153-beb1e8a6e76a" name="Start" type="Start"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><loginhibit /><display x="30" y="-120" /><onsuccess>9a8c4505-8606-4a0c-b118-09a6b9932b3b</onsuccess></stage><stage stageid="9a8c4505-8606-4a0c-b118-09a6b9932b3b" name="End" type="End"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><loginhibit /><display x="30" y="90" /></stage><stage stageid="a130f3e8-fad5-413c-a068-75ac20600244" name="Remove Non-word Characters" type="SubSheetInfo"><subsheetid>65117a41-f7ff-4f3f-abd1-7a3cbe18cfda</subsheetid><narrative>Trims non word characters from the begining and end of the text. Non word characters are any character that is NOT in the ranges a-z A-Z _ and 0-9</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="dd85470c-e10b-4f0b-b729-c006136517eb" name="Start" type="Start"><subsheetid>65117a41-f7ff-4f3f-abd1-7a3cbe18cfda</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Text" narrative="The text to remove the non word characters from" stage="Text" /></inputs><onsuccess>a2426b0a-eab8-4571-a6d9-fa89c49559be</onsuccess></stage><stage stageid="3eae8050-c325-49f6-9e3f-ee12400ca5d4" name="End" type="End"><subsheetid>65117a41-f7ff-4f3f-abd1-7a3cbe18cfda</subsheetid><loginhibit /><display x="15" y="90" /><outputs><output type="text" name="Trimmed Text" narrative="The text with the non word characters removed" stage="Trimmed Text" /></outputs></stage><stage stageid="a2426b0a-eab8-4571-a6d9-fa89c49559be" name="Trim" type="Code"><subsheetid>65117a41-f7ff-4f3f-abd1-7a3cbe18cfda</subsheetid><loginhibit /><display x="15" y="-15" /><inputs><input type="text" name="Text" expr="[Text]" /></inputs><outputs><output type="text" name="Trimmed Text" stage="Trimmed Text" /></outputs><onsuccess>3eae8050-c325-49f6-9e3f-ee12400ca5d4</onsuccess><code><![CDATA[
dim r as new regex("^\W*|\W*$")
Trimmed_Text = r.replace(text, "")
]]></code></stage><stage stageid="1f3570bd-8411-4e92-8fd3-1dd418411570" name="Text" type="Data"><subsheetid>65117a41-f7ff-4f3f-abd1-7a3cbe18cfda</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue xml:space="preserve">    qwerqwer    </initialvalue><private /><alwaysinit /></stage><stage stageid="0967c44a-1a53-49a7-8bb4-e1f6733a41b0" name="Trimmed Text" type="Data"><subsheetid>65117a41-f7ff-4f3f-abd1-7a3cbe18cfda</subsheetid><display x="90" y="-15" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="00a08897-25f2-48e0-aa88-e40bb27b94e7" name="Split Lines" type="SubSheetInfo"><subsheetid>e6bab90c-ddfd-48c0-af38-804fe4f770ed</subsheetid><narrative>Splits multiple line text into a collection text values with a single row per line.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="5f6c9d2f-247d-42a7-bc18-8b4283b21c80" name="Start" type="Start"><subsheetid>e6bab90c-ddfd-48c0-af38-804fe4f770ed</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Text to Split" narrative="The text to split" stage="Text to Split" /></inputs><onsuccess>ee14a8f3-9fd3-4342-abcf-3cbe1d57431a</onsuccess></stage><stage stageid="370a75cf-d54f-438d-b7b1-0f931038d7a2" name="End" type="End"><subsheetid>e6bab90c-ddfd-48c0-af38-804fe4f770ed</subsheetid><loginhibit /><display x="15" y="90" /><outputs><output type="collection" name="Split Values" narrative="The resulting collection containing the split values" stage="Split Values" /></outputs></stage><stage stageid="b655e5fa-2cb9-487a-b4e8-8faf44531e8d" name="Text to Split" type="Data"><subsheetid>e6bab90c-ddfd-48c0-af38-804fe4f770ed</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ee14a8f3-9fd3-4342-abcf-3cbe1d57431a" name="Split" type="Code"><subsheetid>e6bab90c-ddfd-48c0-af38-804fe4f770ed</subsheetid><loginhibit /><display x="15" y="0" /><inputs><input type="text" name="Text to Split" expr="[Text to Split]" /></inputs><outputs><output type="collection" name="Split Values" stage="Split Values" /></outputs><onsuccess>370a75cf-d54f-438d-b7b1-0f931038d7a2</onsuccess><code><![CDATA[Split_Values = SplitStringInto("Value", _
 Text_to_Split, vbCrLf, vbLf, vbCr)]]></code></stage><stage stageid="5c6c7749-e4c1-45ef-9fb7-a7b7ca77214d" name="Split Values" type="Collection"><subsheetid>e6bab90c-ddfd-48c0-af38-804fe4f770ed</subsheetid><display x="120" y="90" w="90" h="60" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Value" type="text" /></collectioninfo></stage><stage stageid="99d3d4f8-598b-44be-9744-5142537aff99" name="Split Text" type="SubSheetInfo"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><narrative>Splits text with a given delimiter into a collection of text values.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="97069dc2-f2a1-4f61-a3f6-e26e88d1da58" name="Start" type="Start"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><loginhibit /><display x="120" y="-105" /><inputs><input type="text" name="Text to Split" narrative="The text to split" stage="Text to Split" /><input type="text" name="Split Char" narrative="The split delimiter" stage="Split Char" /><input type="text" name="Collection Field Name" narrative="The name of the field for the resulting collection" stage="Collection Field Name" /></inputs><onsuccess>d1694d87-2fff-467b-9a07-5f5dd570bd41</onsuccess></stage><stage stageid="2972f0ee-292a-4bb0-bed5-c9a19f8945f6" name="End" type="End"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><loginhibit /><display x="120" y="90" /><outputs><output type="collection" name="Split Values" narrative="The resulting collection containing the split values" stage="Split Values" /></outputs></stage><stage stageid="33bff0c5-22b9-4ab3-ac0a-c352221a4f79" name="Text to Split" type="Data"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><display x="195" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d1694d87-2fff-467b-9a07-5f5dd570bd41" name="Split Text" type="Code"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><loginhibit /><display x="120" y="0" /><inputs><input type="text" name="Text to Split" expr="[Text to Split]" /><input type="text" name="Split Char" expr="[Split Char]" /><input type="text" name="Collection Field Name" expr="[Collection Field Name]" /></inputs><outputs><output type="collection" name="Split Values" stage="Split Values" /></outputs><onsuccess>2972f0ee-292a-4bb0-bed5-c9a19f8945f6</onsuccess><code><![CDATA[Split_Values = SplitStringInto( _
 Collection_Field_Name, _
 Text_to_Split, Split_Char)]]></code></stage><stage stageid="17ffca42-be51-4343-90e3-035d29366b7f" name="Split Values" type="Collection"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><display x="225" y="90" w="90" h="60" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="05ba6aed-e91b-4383-9001-69b78a2e474d" name="Split Char" type="Data"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><display x="255" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="20afce2f-59e1-4fc1-896c-ab71d2f871b2" name="Collection Field Name" type="Data"><subsheetid>a5871062-5ad2-4950-afbc-cb5b1b7a7f0b</subsheetid><display x="45" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="786d2d47-37c8-4324-8e43-8fc75f0eca95" name="Join Text" type="SubSheetInfo"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><narrative>Joins values from a collection into a single line of text using a given delimiter between values.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="ccd8aec8-19c3-4d48-a184-a8895ed1ebbf" name="Start" type="Start"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><preconditions><condition narrative="" /></preconditions><display x="15" y="-105" /><inputs><input type="collection" name="Values" narrative="The text values collection to join" stage="Values" /><input type="text" name="Join Character" narrative="The delimeter between text values" stage="Join Character" /><input type="flag" name="Trim Values" narrative="Set true to apply trimming to the values" stage="Trim Values" /></inputs><onsuccess>b05ea94b-f0d1-4047-b854-04877801ef0b</onsuccess></stage><stage stageid="7dbff5b3-7cd4-406a-9650-265fb88988ef" name="End" type="End"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="15" y="285" /><outputs><output type="text" name="Joined Text" narrative="The resulting joined text" stage="Joined Text" /></outputs></stage><stage stageid="13059fce-ee5a-4fbc-a76c-efc5db5d1240" name="Values" type="Collection"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><display x="90" y="-105" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Item Value" type="text" /></collectioninfo></stage><stage stageid="b0cf2931-5486-4779-b457-e8af03062df8" name="Join Character" type="Data"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><display x="150" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="019a4343-9b5c-4400-8b76-5efbf2156032" name="Join Lines" type="SubSheetInfo"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><narrative>Joins values from a collection into multiline text.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="6f376101-4dd4-43b4-85a0-19dd1090df02" name="Start" type="Start"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><loginhibit /><display x="15" y="-75" /><inputs><input type="collection" name="Values" narrative="The text values collection to join" stage="Values" /><input type="flag" name="Trim Lines" narrative="Set true to apply trimming to the lines" stage="Trim Lines" /></inputs><onsuccess>816591dd-a42d-436b-9fd0-4ca095d78e29</onsuccess></stage><stage stageid="f2d9cbef-9cdb-4daa-bbb6-5d3dc0548c2e" name="Values" type="Collection"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><display x="90" y="-75" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="579d0466-882d-47ce-a2c3-d4a7f25eaa8c" name="Joined Text" type="Data"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><display x="90" y="285" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="724a0223-71bd-48d0-bcca-f4d554fcf91b" name="End" type="End"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><loginhibit /><display x="15" y="135" /><outputs><output type="text" name="Joined Text" narrative="The resulting joined text" stage="Joined Text" /></outputs></stage><stage stageid="8bcc24ca-f588-4c3c-b09b-fe08b425b5db" name="Joined Text" type="Data"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><display x="90" y="135" w="90" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e3b84350-20a1-442e-bebb-0232a5b73299" name="Join Text" type="SubSheet"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><loginhibit /><display x="15" y="60" /><inputs><input type="collection" name="Values" expr="[Values]" /><input type="text" name="Join Character" expr="[Join Character]" /><input type="flag" name="Trim Values" expr="[Trim Lines]" /></inputs><outputs><output type="text" name="Joined Text" stage="Joined Text" /></outputs><onsuccess>724a0223-71bd-48d0-bcca-f4d554fcf91b</onsuccess><processid>a2c09338-7850-4daf-a545-8972d333b826</processid></stage><stage stageid="816591dd-a42d-436b-9fd0-4ca095d78e29" name="Get Carriage Return" type="Code"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><loginhibit /><display x="15" y="0" w="90" h="30" /><outputs><output type="text" name="Join Character" stage="Join Character" /></outputs><onsuccess>e3b84350-20a1-442e-bebb-0232a5b73299</onsuccess><code><![CDATA[Join_Character = vbcrlf]]></code></stage><stage stageid="9a8e3b40-f136-4397-b62b-4a69cd010c37" name="Join Character" type="Data"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><display x="105" y="0" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="13a0e17b-9b82-4dd6-8e3a-313890d8caf3" name="For Each Value" type="LoopStart"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="15" y="15" w="90" h="30" /><onsuccess>e4c0da52-0523-4109-b705-3fadd035597b</onsuccess><groupid>fffab271-8052-4aaf-9a1e-1402d77939ea</groupid><looptype>ForEach</looptype><loopdata>Values</loopdata></stage><stage stageid="98f2416b-599a-42d1-a76f-d41ea3e23572" name="Next Value" type="LoopEnd"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="15" y="195" w="90" h="30" /><onsuccess>7dbff5b3-7cd4-406a-9650-265fb88988ef</onsuccess><groupid>fffab271-8052-4aaf-9a1e-1402d77939ea</groupid></stage><stage stageid="b05ea94b-f0d1-4047-b854-04877801ef0b" name="Reset Output" type="Calculation"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="15" y="-45" /><onsuccess>13a0e17b-9b82-4dd6-8e3a-313890d8caf3</onsuccess><calculation expression="&quot;&quot;" stage="Joined Text" /></stage><stage stageid="49168356-8449-4cb3-9798-0796b15b77a3" name="Append Value" type="Calculation"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="15" y="150" /><onsuccess>98f2416b-599a-42d1-a76f-d41ea3e23572</onsuccess><calculation expression="[Joined Text] &amp; [Values.Item Value] &amp; [Join Character]" stage="Joined Text" /></stage><stage stageid="54cf1a89-b26c-4916-ab45-8f1e80b9b86f" name="Trim Lines" type="Data"><subsheetid>a854bb6a-4399-4e51-8fc3-64f9e1d4f896</subsheetid><display x="150" y="-75" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6aa04814-e2fd-4630-b391-bfe892ddc8df" name="Trim Values" type="Data"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><display x="210" y="-105" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="e4c0da52-0523-4109-b705-3fadd035597b" name="Trim?" type="Decision"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="15" y="75" /><decision expression="[Trim Values]" /><ontrue>91ef5da4-e47e-4442-98ec-d46cbd8d8692</ontrue><onfalse>49168356-8449-4cb3-9798-0796b15b77a3</onfalse></stage><stage stageid="91ef5da4-e47e-4442-98ec-d46cbd8d8692" name="Do Trim" type="Calculation"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="105" y="75" /><onsuccess>10ac89cc-d24c-4622-ad92-34ebe2365083</onsuccess><calculation expression="Trim([Values.Item Value])" stage="Values.Item Value" /></stage><stage stageid="10ac89cc-d24c-4622-ad92-34ebe2365083" name="anchor1" type="Anchor"><subsheetid>a2c09338-7850-4daf-a545-8972d333b826</subsheetid><loginhibit /><display x="105" y="150" w="10" h="10" /><onsuccess>49168356-8449-4cb3-9798-0796b15b77a3</onsuccess></stage><stage stageid="b837f601-57e9-4136-8dee-db8ca9ebf15f" name="Format Number" type="SubSheetInfo"><subsheetid>5110b353-010b-4874-97bd-8b7621c24384</subsheetid><narrative>Formats a number into comma-delimited triplets, as appropriate. Eg 123456.789 becomes 123,456.789</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="df1e573a-3e89-43a8-8e6a-61f1840b3869" name="Start" type="Start"><subsheetid>5110b353-010b-4874-97bd-8b7621c24384</subsheetid><loginhibit /><preconditions><condition narrative="None" /></preconditions><postconditions><condition narrative="The number will have been formatted." /></postconditions><display x="15" y="-105" /><inputs><input type="number" name="Input Number" narrative="The number to format" stage="Input Number" /></inputs><onsuccess>df4ce97f-4b9c-4087-a9bf-c6e35eba156b</onsuccess></stage><stage stageid="dd89bdff-2f14-4268-98f4-7ef3747a5233" name="End" type="End"><subsheetid>5110b353-010b-4874-97bd-8b7621c24384</subsheetid><loginhibit /><display x="15" y="90" /><outputs><output type="text" name="Formatted Currency Numbers" narrative="The resulting formatted number" stage="Formatted Currency Value" /></outputs></stage><stage stageid="b0f25370-1f87-4edd-b03a-0a3ac16537fb" name="Input Number" type="Data"><subsheetid>5110b353-010b-4874-97bd-8b7621c24384</subsheetid><display x="90" y="-105" /><datatype>number</datatype><initialvalue>987654123456.789</initialvalue><private /><alwaysinit /></stage><stage stageid="df4ce97f-4b9c-4087-a9bf-c6e35eba156b" name="Format" type="Code"><subsheetid>5110b353-010b-4874-97bd-8b7621c24384</subsheetid><loginhibit /><display x="15" y="-30" /><inputs><input type="number" name="Input" expr="[Input Number]" /></inputs><outputs><output type="text" name="Output" stage="Formatted Currency Value" /></outputs><onsuccess>dd89bdff-2f14-4268-98f4-7ef3747a5233</onsuccess><code><![CDATA[Output = Input.ToString("N")]]></code></stage><stage stageid="a6d6d631-89c5-4460-9771-6a15a0e1d7d5" name="Formatted Currency Value" type="Data"><subsheetid>5110b353-010b-4874-97bd-8b7621c24384</subsheetid><display x="90" y="90" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b3013d63-9017-4dd9-bcf6-5e0d09ab372f" name="PadLeft" type="SubSheetInfo"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><narrative>Ensures that a string (usually a number) is of fixed width, by padding with a special character on the left.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="af05cd75-42db-4c09-875d-3fedfc3ca0a2" name="Start" type="Start"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><preconditions><condition narrative="None" /></preconditions><postconditions><condition narrative="The supplied text will have been padded to be at least the number of desired characters." /></postconditions><display x="15" y="-105" /><inputs><input type="text" name="Input String" narrative="The string to pad" stage="Input String" /><input type="number" name="Target Width" narrative="The total number of characters required after padding" stage="Target Width" /><input type="text" name="Padding Character" narrative="The character to pad with" stage="Padding Character" /></inputs><onsuccess>6527cdd9-47d7-4784-bd96-e63afa4ec955</onsuccess></stage><stage stageid="f432b972-ae44-4485-943b-87848fd43487" name="End" type="End"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><display x="15" y="165" /><outputs><output type="text" name="Padded String" narrative="The resultant padded string" stage="Input String" /></outputs></stage><stage stageid="888a814c-a03d-43f0-b6d6-30501b8b3250" name="Input String" type="Data"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue xml:space="preserve">123</initialvalue><private /><alwaysinit /></stage><stage stageid="ea8d90c7-c341-4859-919c-4ecc076162eb" name="Target Width" type="Data"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><display x="150" y="-105" /><datatype>number</datatype><initialvalue>5</initialvalue><private /><alwaysinit /></stage><stage stageid="56c037f3-4ff0-4923-974c-e925c84e69c8" name="Padding Character" type="Data"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><display x="210" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6527cdd9-47d7-4784-bd96-e63afa4ec955" name="Blank Padding Character?" type="Decision"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><display x="15" y="-45" w="90" h="30" /><decision expression="Len([Padding Character]) = 0" /><ontrue>26f66718-649a-4472-965d-0e1e125e7473</ontrue><onfalse>b6b30eec-0ee3-4316-a9af-d0a55d5ec137</onfalse></stage><stage stageid="26f66718-649a-4472-965d-0e1e125e7473" name="Use Space for Padding" type="Calculation"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><display x="135" y="-45" w="90" h="30" /><onsuccess>6acfdd2b-9298-4841-9111-003fc203edd0</onsuccess><calculation expression="&quot; &quot;" stage="Padding Character" /></stage><stage stageid="6acfdd2b-9298-4841-9111-003fc203edd0" name="anchor2" type="Anchor"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><display x="135" y="0" w="10" h="10" /><onsuccess>b6b30eec-0ee3-4316-a9af-d0a55d5ec137</onsuccess></stage><stage stageid="b6b30eec-0ee3-4316-a9af-d0a55d5ec137" name="anchor3" type="Anchor"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><display x="15" y="0" w="10" h="10" /><onsuccess>e13c9c2d-2cbe-4262-828c-6307a805d9c1</onsuccess></stage><stage stageid="e13c9c2d-2cbe-4262-828c-6307a805d9c1" name="Long Enough?" type="Decision"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><display x="15" y="60" /><decision expression="Len([Input String]) &gt;= [Target Width]" /><ontrue>f432b972-ae44-4485-943b-87848fd43487</ontrue><onfalse>87af11ea-fa7e-45cf-b02a-fd6edeae0b85</onfalse></stage><stage stageid="87af11ea-fa7e-45cf-b02a-fd6edeae0b85" name="Insert Padding" type="Calculation"><subsheetid>ef8de52d-842b-45f0-8f1b-619bc97d4bbc</subsheetid><loginhibit /><display x="135" y="60" /><onsuccess>6acfdd2b-9298-4841-9111-003fc203edd0</onsuccess><calculation expression="[Padding Character] &amp; [Input String]" stage="Input String" /></stage><stage stageid="92edef27-4b78-40dd-97bd-e5a4f9169214" name="Get XML Elements" type="SubSheetInfo"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><narrative>Gets a collection of xml elements with a given name from an xml document.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="04bec0f1-e8bb-4c30-a5d1-b7eee243e6f9" name="Start" type="Start"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><loginhibit /><display x="135" y="-120" /><inputs><input type="text" name="XML" narrative="The xml to get elements from" stage="XML" /><input type="text" name="Element Name" narrative="The name of the xml elements to get" stage="Element Name" /></inputs><onsuccess>17f4a862-c7e3-44c3-a373-5b325fdaab8a</onsuccess></stage><stage stageid="e4b99f55-7171-46d6-992b-db797e99b1ed" name="End" type="End"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><loginhibit /><display x="135" y="165" /><outputs><output type="collection" name="Elements" narrative="The collection of xml elements that match the given name and for each element its outer xml" stage="Elements" /></outputs></stage><stage stageid="31472749-70ee-477e-a042-fcf5a25a4099" name="XML" type="Data"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><display x="-75" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">&lt;?xml version="1.0" encoding="utf-8" ?&gt; &lt;PotentialGrading&gt;  &lt;ServiceIdentifier&gt;ABC&lt;/ServiceIdentifier&gt;  &lt;Episode ID="a97fe424-0d1f-4e7c-9e9a-9b3c9e03d594"&gt;   &lt;Patient DateOfBirth="18/02/1970" Gender="M" PartPostcode="YO51" EthnicOrigin="W" Country="United Kingdom"    Region="North Yorkshire" RegisteredBlind="0" RegisteredPartiallySighted="1" HealthProvider="PCT"    Insurance="Cheap as Chips Insurance"&gt;The patient ID goes here&lt;/Patient&gt;   &lt;Screening Date="2007/09/06" GradingCodeSet="NGC" ImageCount="4"&gt;    &lt;Item Code="Examiner Classification" Value="1" /&gt;    &lt;Item Code="Eye Screening Urgency" Value="2" /&gt;    &lt;Item Code="Opthalmologist Care" Value="2" /&gt;    &lt;Item Code="Technical Gradability Code" Value="1" /&gt;    &lt;Item Code="01 Visual Acuity Pinhole" Value="0" Laterality="right" /&gt;    &lt;Item Code="01 Visual Acuity Pinhole" Value="0" Laterality="left" /&gt;    &lt;Item Code="02 Visual Acuity Spectacles" Value="0" Laterality="right" /&gt;    &lt;Item Code="02 Visual Acuity Spectacles" Value="0" Laterality="left" /&gt;    &lt;Item Code="03 Visual Acuity Standard" Value="1" Laterality="right" /&gt;    &lt;Item Code="03 Visual Acuity Standard" Value="1" Laterality="left" /&gt;    &lt;Item Code="04 Visual Acuity" Value="" Laterality="right"&gt;Free text entry&lt;/Item&gt;    &lt;Item Code="04 Visual Acuity" Value="" Laterality="left"&gt;Free text entry&lt;/Item&gt;    &lt;Item Code="06 Dilation" Value="1" Laterality="right" /&gt;    &lt;Item Code="06 Dilation" Value="1" Laterality="left" /&gt;    &lt;Image Length="104644" CameraID="Camera1" CameraModelID="CameraModel1" CaptureDateTime="2007/09/06T01:54:59"     Eye="L"&gt;1121017(5)L.jpg&lt;/Image&gt;    &lt;Image Length="107565" CameraID="Camera2" CameraModelID="CameraModel2" CaptureDateTime="2007/09/06T01:54:59"     Eye="L"&gt;1121017(6)L.jpg&lt;/Image&gt;    &lt;Image Length="107441" CameraID="Camera3" CameraModelID="CameraModel3" CaptureDateTime="2007/09/06T01:54:59"     Eye="R"&gt;1121017(5)R.jpg&lt;/Image&gt;    &lt;Image Length="112472" CameraID="Camera4" CameraModelID="CameraModel4" CaptureDateTime="2007/09/06T01:54:59"     Eye="R"&gt;1121017(6)R.jpg&lt;/Image&gt;   &lt;/Screening&gt;   &lt;Notes&gt;Free text notes go here&lt;/Notes&gt;  &lt;/Episode&gt; &lt;/PotentialGrading&gt; </initialvalue><private /><alwaysinit /></stage><stage stageid="68a0eeb2-9377-4b12-8f31-5ae52e7109e4" name="Element Name" type="Data"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><display x="-75" y="90" w="150" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">Image</initialvalue><private /><alwaysinit /></stage><stage stageid="7b46fe82-142a-411b-bf80-b2f0047952da" name="Get Elements" type="Code"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><loginhibit /><display x="135" y="60" /><inputs><input type="text" name="XML" expr="[XML]" /><input type="text" name="Element" expr="[Element Name]" /></inputs><outputs><output type="collection" name="Elements" stage="Elements" /></outputs><onsuccess>e4b99f55-7171-46d6-992b-db797e99b1ed</onsuccess><code><![CDATA[
dim table as datatable = GetDataTable("XML", "System.String")
dim row as datarow
dim doc as new xmldocument
dim list as xmlnodelist

doc.loadxml(xml)
list = doc.getelementsbytagname(element)

for each n as xmlnode in list
	row = table.newrow()
	row("XML") = n.outerxml
	table.rows.Add(row)
next

Elements = table
]]></code></stage><stage stageid="d693d2fb-a196-4ddc-b2e9-b41cbe618fc3" name="Elements" type="Collection"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><display x="-75" y="165" w="150" h="90" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="17f4a862-c7e3-44c3-a373-5b325fdaab8a" name="Blank XML?" type="Decision"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><loginhibit /><display x="135" y="-30" /><decision expression="Len(Trim([XML])) = 0" /><ontrue>6eb4f747-35c0-4e57-acbf-be93ac0a1bbb</ontrue><onfalse>7b46fe82-142a-411b-bf80-b2f0047952da</onfalse></stage><stage stageid="6eb4f747-35c0-4e57-acbf-be93ac0a1bbb" name="anchor1" type="Anchor"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><loginhibit /><display x="240" y="-30" w="10" h="10" /><onsuccess>a460ec9b-8afb-4b37-8ae0-7545448b025d</onsuccess></stage><stage stageid="a460ec9b-8afb-4b37-8ae0-7545448b025d" name="anchor2" type="Anchor"><subsheetid>818441a5-ffec-4841-b0ea-00712caf63aa</subsheetid><loginhibit /><display x="240" y="165" w="10" h="10" /><onsuccess>e4b99f55-7171-46d6-992b-db797e99b1ed</onsuccess></stage><stage stageid="97b59270-9eda-4994-9fce-24d8b5d856a4" name="Get XML Attribute" type="SubSheetInfo"><subsheetid>e8af11f7-dfd4-4c86-9935-e83828b9e711</subsheetid><narrative>Gets the value of an xml attribute with a given name from an xml document fragment.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="802dd6e8-6b25-42b9-9af6-931049d4062a" name="Start" type="Start"><subsheetid>e8af11f7-dfd4-4c86-9935-e83828b9e711</subsheetid><loginhibit /><display x="120" y="-105" /><inputs><input type="text" name="XML" narrative="The xml document to get attributes from" stage="XML" /><input type="text" name="Attribute Name" narrative="The name of the xml attribute to get" stage="Attribute Name" /></inputs><onsuccess>76737597-b716-4a52-8cbc-dfe9b5ad1f0c</onsuccess></stage><stage stageid="bc64fcfd-4386-47ec-b799-19c5454d8374" name="End" type="End"><subsheetid>e8af11f7-dfd4-4c86-9935-e83828b9e711</subsheetid><loginhibit /><display x="120" y="90" /><outputs><output type="text" name="Value" narrative="The text value of the requested attribute" stage="Attribute Value" /></outputs></stage><stage stageid="18f2ae57-8ed9-457b-8763-82dedb14a5e0" name="XML" type="Data"><subsheetid>e8af11f7-dfd4-4c86-9935-e83828b9e711</subsheetid><display x="-90" y="75" w="150" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">&lt;iGrading&gt;&lt;Response transactionID="de3dc0b1-6b22-4b67-a13a-d42fff6188b9" status="Success" method="SubmitPotentialGradingWithImages" description="" /&gt;&lt;/iGrading&gt;</initialvalue><private /><alwaysinit /></stage><stage stageid="1941e7f9-164d-4aa2-b06e-cb3a579a30e4" name="Attribute Name" type="Data"><subsheetid>e8af11f7-dfd4-4c86-9935-e83828b9e711</subsheetid><display x="-90" y="105" w="150" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">method</initialvalue><private /><alwaysinit /></stage><stage stageid="c9ec2a39-8f5d-42cc-856f-33bdb2c16477" name="Attribute Value" type="Data"><subsheetid>e8af11f7-dfd4-4c86-9935-e83828b9e711</subsheetid><display x="-90" y="135" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="76737597-b716-4a52-8cbc-dfe9b5ad1f0c" name="Get Attribute" type="Code"><subsheetid>e8af11f7-dfd4-4c86-9935-e83828b9e711</subsheetid><loginhibit /><display x="120" y="-15" /><inputs><input type="text" name="XML" expr="[XML]" /><input type="text" name="Attribute" expr="[Attribute Name]" /></inputs><outputs><output type="text" name="Value" stage="Attribute Value" /></outputs><onsuccess>bc64fcfd-4386-47ec-b799-19c5454d8374</onsuccess><code><![CDATA[
dim i as integer = XML.indexof(Attribute)

if i > 0 then
	i += Attribute.length + 2
	value = XML.substring(i)
	value = value.substring(0, value.indexof(""""))
else
	value = ""
end if]]></code></stage><stage stageid="ebd306f5-f0a3-46cf-8a04-9bde5bf5cc3d" name="Get Collection as CSV" type="SubSheetInfo"><subsheetid>f9add4d4-31de-4c0f-a109-0b51fa576a23</subsheetid><narrative>Turns a collection into a list of comma seperated values.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="1e2d9aba-666e-457b-adb8-c5991d17ba24" name="Start" type="Start"><subsheetid>f9add4d4-31de-4c0f-a109-0b51fa576a23</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="collection" name="Input Collection" narrative="The collection to be converted to CSV" stage="Input Collection" /></inputs><onsuccess>e5946197-de00-4008-9491-d0ab28eaf2ee</onsuccess></stage><stage stageid="a619ae29-9260-47d3-b15c-f47342810991" name="End" type="End"><subsheetid>f9add4d4-31de-4c0f-a109-0b51fa576a23</subsheetid><loginhibit /><display x="15" y="90" /><outputs><output type="text" name="Collection CSV" narrative="The CSV representation of the Input Collection" stage="Output CSV" /></outputs></stage><stage stageid="18eea322-16ab-4d30-a555-5ac6638b468f" name="Input Collection" type="Collection"><subsheetid>f9add4d4-31de-4c0f-a109-0b51fa576a23</subsheetid><display x="120" y="-105" w="120" h="60" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e5946197-de00-4008-9491-d0ab28eaf2ee" name="Serialise to CSV" type="Code"><subsheetid>f9add4d4-31de-4c0f-a109-0b51fa576a23</subsheetid><loginhibit /><display x="15" y="0" w="120" h="30" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="text" name="Output CSV" stage="Output CSV" /></outputs><onsuccess>a619ae29-9260-47d3-b15c-f47342810991</onsuccess><code><![CDATA[
Dim SB As New StringBuilder
WriteDataTable(SB, Input_Collection, True)
Output_CSV = SB.ToString()]]></code></stage><stage stageid="9e68e0db-adac-4a32-bd92-c7d5bfe31468" name="Output CSV" type="Data"><subsheetid>f9add4d4-31de-4c0f-a109-0b51fa576a23</subsheetid><display x="90" y="90" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="47ea7760-3b58-442b-8271-c90d3c08f114" name="Split Lines by Length" type="SubSheetInfo"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><narrative>Splits text into lines of a given length using word boundries to find the split point.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="51996cc8-b76e-4de1-899a-66c678dbe1f3" name="Start" type="Start"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><loginhibit /><display x="0" y="-135" /><inputs><input type="text" name="Text to Split" narrative="The single line of text that needs to be split" stage="Text to Split" /><input type="number" name="Maximum Line Length" narrative="The maximum length of the line" stage="Maximum Line Length" /><input type="flag" name="Split Strictly by Length" narrative="Set true if the line should be split at character boundries instead of words" stage="Split Strictly by Length" /></inputs><onsuccess>0fd3f2cd-7fff-49c7-b4d9-4cfc3476793a</onsuccess></stage><stage stageid="52e75580-936a-4647-a154-e984ab8d199a" name="End" type="End"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><loginhibit /><display x="0" y="60" /><outputs><output type="number" name="Line Count" stage="Line Count" /><output type="collection" name="Split Lines" stage="Split Lines" /></outputs></stage><stage stageid="0fd3f2cd-7fff-49c7-b4d9-4cfc3476793a" name="Split Lines By Length" type="Code"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><loginhibit /><display x="0" y="-45" w="90" h="60" /><inputs><input type="text" name="Text to Split" expr="[Text to Split]" /><input type="number" name="Maximum Line Length" expr="[Maximum Line Length]" /><input type="flag" name="Strict Split" expr="[Split Strictly by Length]" /></inputs><outputs><output type="collection" name="Split Lines" stage="Split Lines" /><output type="number" name="Line Count" stage="Line Count" /></outputs><onsuccess>52e75580-936a-4647-a154-e984ab8d199a</onsuccess><code><![CDATA[Dim Values as List(Of String) = Nothing
If Strict_Split Then
      Values = New List(Of String)
      While Text_to_Split.Length > 0
            Dim NewLine As String = Text_to_Split.SubString(0, Math.Min(Maximum_Line_Length, Text_to_Split.Length))
            NewLine = NewLine.Trim()
            Values.Add(NewLine)

            If Text_to_Split.Length > NewLine.Length Then
                  Text_to_Split = Text_to_Split.SubString(NewLine.Length, Text_to_Split.Length - NewLine.Length)
            Else
                  Text_to_Split = ""
            End If
            Text_to_Split = Text_to_Split.Trim()
      End While
Else
      Values = SplitTextByLengthEngine(Text_to_Split, Maximum_Line_length)
End If

Split_Lines = New DataTable()
Split_Lines.Columns.Add("Line Text", GetType(String))
For Each s as String in Values
      Split_Lines.Rows.Add(New Object() {s})
Next

Line_Count = Values.Count]]></code></stage><stage stageid="c20b3e81-de90-46c1-a347-f094034ff28c" name="Text to Split" type="Data"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><display x="75" y="-135" /><datatype>text</datatype><initialvalue xml:space="preserve">aaaa bbbb cccc dddd eeee ffff gggg hhhh iiii jjjj kkkk llll mmmm nnnn oooo pppp</initialvalue><private /><alwaysinit /></stage><stage stageid="e329d1c6-7a17-4af0-aa33-d6fb517adb68" name="Split Lines" type="Collection"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><display x="135" y="45" w="120" h="90" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Line Text" type="text" /></collectioninfo></stage><stage stageid="50f47d4a-73f4-46d2-93e1-24a2470d2df9" name="Maximum Line Length" type="Data"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><display x="150" y="-135" /><datatype>number</datatype><initialvalue>6</initialvalue><private /><alwaysinit /></stage><stage stageid="d1f11813-b465-4a95-9194-630fb1424d37" name="Line Count" type="Data"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><display x="90" y="-60" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="89c59225-5fb8-45a8-9fb8-a102420ddbc5" name="Split Strictly by Length" type="Data"><subsheetid>6a710d42-8f41-45d0-9e74-1eddf74c0e75</subsheetid><display x="225" y="-135" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="8d911bb3-c87f-4748-b226-9d2faaf45c95" name="Get CSV As Collection" type="SubSheetInfo"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><narrative>Turns a list of comma seperated values into a collection.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="90168461-d901-4bf7-886d-42176fe2fe34" name="Start" type="Start"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><loginhibit /><display x="150" y="-105" /><inputs><input type="text" name="CSV" narrative="The CSV to be converted into a collection" stage="CSV" /><input type="flag" name="First Row Is Header" narrative="Indicates whether the first row of the CSV file should be treated as headers" stage="First Row Is Header" /><input type="collection" name="Schema" narrative="Optional. A collection of column names. If left blank the column names will be taken from the first row. " stage="Schema" /></inputs><onsuccess>33e5caa5-61ec-4ef6-9ae8-01466a277896</onsuccess></stage><stage stageid="f06f6c62-eada-49b0-bf89-fdbb436e13fe" name="End" type="End"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><loginhibit /><display x="150" y="15" /><outputs><output type="collection" name="Output Collection" narrative="The collection converted from CSV" stage="Output Collection" /></outputs></stage><stage stageid="d5778bd8-695a-4c5e-8e8a-3764ae34f57f" name="CSV" type="Data"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><loginhibit /><display x="225" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c5b7df42-71fd-41f6-af35-62ed6f68caa0" name="Output Collection" type="Collection"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><loginhibit /><display x="45" y="15" w="120" h="60" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="617f911a-8f73-4ce5-b428-f1441214c602" name="First Row Is Header" type="Data"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><loginhibit /><display x="285" y="-105" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="ff699bd2-cd5a-4996-927a-e579b22b0313" name="Schema" type="Collection"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><narrative>The columns must appear in the same order as they appear in the CSV file</narrative><display x="390" y="-105" w="120" h="60" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Column Name" type="text" /></collectioninfo></stage><stage stageid="e1587123-3967-4743-b475-5499f8c41803" name="Get Newline Character" type="SubSheetInfo"><subsheetid>fcddf4bf-83af-4431-88db-cc2c88390cec</subsheetid><narrative>Gets the text representing the two newline characters used under windows (Carriage return followed by Line feed)</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="b09f1e76-fb7c-4ef1-9a47-db4a1377d056" name="Start" type="Start"><subsheetid>fcddf4bf-83af-4431-88db-cc2c88390cec</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>af411d25-0e83-4e28-b4f3-30f43beb9b88</onsuccess></stage><stage stageid="bee4d44f-957c-415f-be9c-614e97d6f255" name="End" type="End"><subsheetid>fcddf4bf-83af-4431-88db-cc2c88390cec</subsheetid><loginhibit /><display x="15" y="90" /><outputs><output type="text" name="Newline Character" narrative="The new line text" stage="Newline Character" /></outputs></stage><stage stageid="af411d25-0e83-4e28-b4f3-30f43beb9b88" name="Get Newline Character" type="Code"><subsheetid>fcddf4bf-83af-4431-88db-cc2c88390cec</subsheetid><loginhibit /><display x="15" y="0" w="90" h="60" /><outputs><output type="text" name="Newline Character" stage="Newline Character" /></outputs><onsuccess>bee4d44f-957c-415f-be9c-614e97d6f255</onsuccess><code><![CDATA[Newline_Character = VbCrLf]]></code></stage><stage stageid="dde302f4-2b62-45c0-a8f3-190c52116470" name="Newline Character" type="Data"><subsheetid>fcddf4bf-83af-4431-88db-cc2c88390cec</subsheetid><display x="90" y="90" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dd7d11e6-2bc7-40ed-ab47-1180482d82ed" name="Delete Characters" type="SubSheetInfo"><subsheetid>e70e8f13-02df-4b14-bb74-6fd5c4c95928</subsheetid><narrative>Removes the given characters from the text.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="6e15c3f7-07db-4e3d-a24d-84be7e09b06e" name="Start" type="Start"><subsheetid>e70e8f13-02df-4b14-bb74-6fd5c4c95928</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Text Sample" narrative="The piece of text to be operated on" stage="Text Sample" /><input type="text" name="Characters to Delete" narrative="A string of characters to be deleted from the Text Sample" stage="Characters to Delete" /></inputs><onsuccess>89bfbefd-b0a3-472a-b72c-75105d0a7895</onsuccess></stage><stage stageid="c7719606-01b9-4626-9a24-4d9cf42d1e75" name="End" type="End"><subsheetid>e70e8f13-02df-4b14-bb74-6fd5c4c95928</subsheetid><loginhibit /><display x="15" y="90" /><outputs><output type="text" name="Amended Sample" narrative="The amended sample, with the characters deleted" stage="Amended Sample" /></outputs></stage><stage stageid="78d405b1-aa60-46a6-af38-fb4bba55e752" name="Text Sample" type="Data"><subsheetid>e70e8f13-02df-4b14-bb74-6fd5c4c95928</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="66318e10-ff11-43c1-9b3c-6ce27546458f" name="Characters to Delete" type="Data"><subsheetid>e70e8f13-02df-4b14-bb74-6fd5c4c95928</subsheetid><display x="150" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="89bfbefd-b0a3-472a-b72c-75105d0a7895" name="Replace" type="Code"><subsheetid>e70e8f13-02df-4b14-bb74-6fd5c4c95928</subsheetid><loginhibit /><display x="15" y="-15" /><inputs><input type="text" name="Text Sample" expr="[Text Sample]" /><input type="text" name="Characters to Delete" expr="[Characters to Delete]" /></inputs><outputs><output type="text" name="Amended Sample" stage="Amended Sample" /></outputs><onsuccess>c7719606-01b9-4626-9a24-4d9cf42d1e75</onsuccess><code><![CDATA[For Each C as Char in Characters_To_Delete.ToCharArray()
	Text_Sample = Text_Sample.Replace(C, "")
Next

Amended_Sample = Text_Sample]]></code></stage><stage stageid="930e7d0f-68a5-4d40-a291-e2dcfa4918c6" name="Amended Sample" type="Data"><subsheetid>e70e8f13-02df-4b14-bb74-6fd5c4c95928</subsheetid><display x="90" y="90" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6a0bb945-2946-4e17-8e4a-b8d7eb5e1060" name="Escape Sendkeys String" type="SubSheetInfo"><subsheetid>040cc29a-27ac-402c-8a66-328554dd4bc0</subsheetid><narrative>Escapes characters to be sent via the sendkeys method, to ensure that all characters are interpreted literally. If left unescaped, some characters such as % carry a special meaning rather than their literal value.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="5bb1d666-6ef6-4371-a0f4-111fdf5ee69e" name="Start" type="Start"><subsheetid>040cc29a-27ac-402c-8a66-328554dd4bc0</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Sendkeys Text" narrative="The text to be escaped" stage="Sendkeys Text" /></inputs><onsuccess>5ea70bdd-732c-4a8e-b5cb-a747f97e1090</onsuccess></stage><stage stageid="7bfda30d-2f75-46ec-b5e2-88a965528b49" name="End" type="End"><subsheetid>040cc29a-27ac-402c-8a66-328554dd4bc0</subsheetid><loginhibit /><display x="15" y="90" /><outputs><output type="text" name="Escaped Sendkeys Text" narrative="The escaped sendkeys text, which can be sent via the sendkeys method without fear of misinterpretation" stage="Escaped Sendkeys Text" /></outputs></stage><stage stageid="5ea70bdd-732c-4a8e-b5cb-a747f97e1090" name="Escape Text" type="Code"><subsheetid>040cc29a-27ac-402c-8a66-328554dd4bc0</subsheetid><loginhibit /><display x="15" y="-30" w="90" h="30" /><inputs><input type="text" name="SendKeys Text" expr="[Sendkeys Text]" /></inputs><outputs><output type="text" name="Escaped Sendkeys Text" stage="Escaped Sendkeys Text" /></outputs><onsuccess>7bfda30d-2f75-46ec-b5e2-88a965528b49</onsuccess><code><![CDATA[Escaped_Sendkeys_Text = Regex.Replace(SendKeys_Text, "[\[\]{}+^%~()]", "{$0}")]]></code></stage><stage stageid="c0e80092-2acc-4552-b6ab-9e3fa5abb07a" name="Escaped Sendkeys Text" type="Data"><subsheetid>040cc29a-27ac-402c-8a66-328554dd4bc0</subsheetid><display x="150" y="90" w="180" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="172f06e8-629e-434a-9bee-084a177606eb" name="Sendkeys Text" type="Data"><subsheetid>040cc29a-27ac-402c-8a66-328554dd4bc0</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4e2f3e3d-72e1-4483-b79e-49e9f1387d8a" name="Compare Font Text" type="SubSheetInfo"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><narrative>Compares two items of text read using Font Recognition for equality, where "equality" means that the two text samples match following the removal of conflicting font characters.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="1a092a3a-7389-4bd7-8d31-a3ed761ff97c" name="Start" type="Start"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><loginhibit /><preconditions><condition narrative="None" /></preconditions><postconditions><condition narrative="None" /></postconditions><display x="150" y="-30" /><inputs><input type="text" name="Sample 1" narrative="The first item to be compared" stage="Sample 1" /><input type="text" name="Sample 2" narrative="The second item to be compared" stage="Sample 2" /><input type="collection" name="Conflicting Characters" narrative="A collection of conflicting font characters, as read from a read stage for the font of interest" stage="Conflicting Characters" /></inputs><onsuccess>2aac81fd-1231-450b-94e5-3a5928ddb08b</onsuccess></stage><stage stageid="f07d147e-0807-4996-8746-e6b232b63283" name="End" type="End"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><loginhibit /><display x="150" y="330" /><outputs><output type="flag" name="Samples Equal" narrative="Indicates whether the samples are equal, once conflicting characters are removed" stage="Samples Equal" /><output type="text" name="Amended Sample 1" narrative="The first sample, with conflicting characters removed" stage="Sample 1" /><output type="text" name="Amended Sample 2" narrative="The second sample, with conflicting characters removed" stage="Sample 2" /></outputs></stage><stage stageid="fbb964d4-b0d6-4729-b88d-04d1cbfd0cb5" name="Sample 1" type="Data"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><display x="225" y="-30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4187bcbb-ee93-4b01-b7b6-4e4944c8967a" name="Sample 2" type="Data"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><display x="285" y="-30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="accd1aa8-9b1f-4fd9-9899-261c2cb84f68" name="Delete from Sample 1" type="Action"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><loginhibit /><display x="150" y="90" /><inputs><input type="text" name="Text Sample" narrative="The piece of text to be operated on" expr="[Sample 1]" /><input type="text" name="Characters to Delete" narrative="A string of characters to be deleted from the Text Sample" expr="[Conflicting Characters.Character Group]" /></inputs><outputs><output type="text" name="Amended Sample" narrative="The amended sample, with the characters deleted" stage="Sample 1" /></outputs><onsuccess>cb02a7ab-2cdb-4263-b5b9-e803d6647cf2</onsuccess><resource object="Utility - Strings" action="Delete Characters" /></stage><stage stageid="16d61c29-acde-49f1-a0dc-5b93885cb724" name="Conflicting Characters" type="Collection"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><display x="0" y="-15" w="120" h="60" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2aac81fd-1231-450b-94e5-3a5928ddb08b" name="For Each Character Group" type="LoopStart"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><loginhibit /><display x="150" y="45" w="120" h="30" /><onsuccess>accd1aa8-9b1f-4fd9-9899-261c2cb84f68</onsuccess><groupid>d5a546ca-79ce-4ba9-917c-4165b543a787</groupid><looptype>ForEach</looptype><loopdata>Conflicting Characters</loopdata></stage><stage stageid="5f4d2cf9-a6a3-47c1-beed-8c8912b3f81e" name="Next Character Group" type="LoopEnd"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><loginhibit /><display x="150" y="180" w="120" h="30" /><onsuccess>cd3e8b56-7767-489d-96de-6c9d0740de02</onsuccess><groupid>d5a546ca-79ce-4ba9-917c-4165b543a787</groupid></stage><stage stageid="cb02a7ab-2cdb-4263-b5b9-e803d6647cf2" name="Delete from Sample 2" type="Action"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><loginhibit /><display x="150" y="135" /><inputs><input type="text" name="Text Sample" narrative="The piece of text to be operated on" expr="[Sample 2]" /><input type="text" name="Characters to Delete" narrative="A string of characters to be deleted from the Text Sample" expr="[Conflicting Characters.Character Group]" /></inputs><outputs><output type="text" name="Amended Sample" narrative="The amended sample, with the characters deleted" stage="Sample 2" /></outputs><onsuccess>5f4d2cf9-a6a3-47c1-beed-8c8912b3f81e</onsuccess><resource object="Utility - Strings" action="Delete Characters" /></stage><stage stageid="cd3e8b56-7767-489d-96de-6c9d0740de02" name="Determine Equality" type="Calculation"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><loginhibit /><display x="150" y="240" /><onsuccess>f07d147e-0807-4996-8746-e6b232b63283</onsuccess><calculation expression="[Sample 1] = [Sample 2]" stage="Samples Equal" /></stage><stage stageid="7c680a7d-326b-4d7b-b298-02df94778092" name="Samples Equal" type="Data"><subsheetid>527ca986-a03f-4231-880e-5b1c244b035e</subsheetid><display x="225" y="330" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a589a76f-6d45-4f76-a3d8-a7220c5409ed" name="Extract Regex Values" type="SubSheetInfo"><subsheetid>06780f7c-9622-4d84-9db3-bb56a2ff9f36</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="e85db034-efea-43db-9f60-c5d086ce0f5a" name="Start" type="Start"><subsheetid>06780f7c-9622-4d84-9db3-bb56a2ff9f36</subsheetid><loginhibit /><display x="45" y="-105" /><inputs><input type="text" name="Regex Pattern" narrative="The regex pattern to apply" stage="Regex Pattern" /><input type="text" name="Target String" narrative="The target string to which apply the pattern and extract values" stage="Target String" /><input type="collection" name="Named Values" narrative="A collection of named values to extract from the target string" stage="Named Values" /></inputs><onsuccess>526b7aa5-2df6-4a52-a8d5-fef9e3c9e776</onsuccess></stage><stage stageid="78d491bd-ce28-422a-8d1f-334ba9248f4e" name="End" type="End"><subsheetid>06780f7c-9622-4d84-9db3-bb56a2ff9f36</subsheetid><loginhibit /><display x="45" y="90" /><outputs><output type="collection" name="Named Values" narrative="Results of the named values extracted from the regex" stage="Named Values" /></outputs></stage><stage stageid="e0d2e8e4-b2f1-4cab-a39c-7252cd042e68" name="Regex Pattern" type="Data"><subsheetid>06780f7c-9622-4d84-9db3-bb56a2ff9f36</subsheetid><display x="240" y="-105" w="300" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">(?&lt;Lower&gt;\d+)\s*(-|to)\s*(?&lt;Upper&gt;\d+)</initialvalue><private /><alwaysinit /></stage><stage stageid="d1344ba9-2a6f-4a88-bc72-0188e2ead8b7" name="Target String" type="Data"><subsheetid>06780f7c-9622-4d84-9db3-bb56a2ff9f36</subsheetid><narrative>100-200
56 to 99
400 - 600</narrative><display x="240" y="-60" w="300" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">100-200</initialvalue><private /><alwaysinit /></stage><stage stageid="70580e44-41d3-40b3-9b12-3460963b2f5f" name="Named Values" type="Collection"><subsheetid>06780f7c-9622-4d84-9db3-bb56a2ff9f36</subsheetid><display x="240" y="30" w="150" h="90" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Name" type="text" /><field name="Value" type="text" /></collectioninfo><initialvalue><row><field name="Name" type="text" value="Lower" /><field name="Value" type="text" value="" /></row><row><field name="Name" type="text" value="Upper" /><field name="Value" type="text" value="" /></row></initialvalue></stage><stage stageid="526b7aa5-2df6-4a52-a8d5-fef9e3c9e776" name="Extract Values" type="Code"><subsheetid>06780f7c-9622-4d84-9db3-bb56a2ff9f36</subsheetid><loginhibit /><display x="45" y="-15" /><inputs><input type="text" name="Regex Pattern" expr="[Regex Pattern]" /><input type="text" name="Target String" expr="[Target String]" /><input type="collection" name="Named Values" expr="[Named Values]" /></inputs><outputs><output type="collection" name="Named Values Out" stage="Named Values" /></outputs><onsuccess>78d491bd-ce28-422a-8d1f-334ba9248f4e</onsuccess><code><![CDATA[For Each Row As DataRow in Named_Values.Rows
	Row("Value") = ""
Next


Dim R as New Regex(Regex_Pattern, RegexOptions.SingleLine)
Dim M as Match = R.Match(Target_String)
If M IsNot Nothing AndAlso M.Success Then
	If M.Groups IsNot Nothing AndAlso M.Groups.Count > 0 Then
		For Each Row As DataRow in Named_Values.Rows
			Dim GroupName As String = CStr(Row("Name"))
			Dim G As Group = M.Groups(GroupName)
			If G.Success Then
				Row("Value") = G.Value
			End If
		Next
	End If
End If

Named_Values_Out = Named_Values]]></code></stage><stage stageid="33e5caa5-61ec-4ef6-9ae8-01466a277896" name="ParseCSV" type="Code"><subsheetid>f5b26213-5463-4b2d-b10f-b188876b436f</subsheetid><loginhibit /><display x="150" y="-45" /><inputs><input type="text" name="CSV" expr="[CSV]" /><input type="collection" name="Schema" expr="[Schema]" /><input type="flag" name="FirstRowIsHeader" expr="[First Row Is Header]" /></inputs><outputs><output type="collection" name="outputCollection" stage="Output Collection" /></outputs><onsuccess>f06f6c62-eada-49b0-bf89-fdbb436e13fe</onsuccess><code><![CDATA[Const SchemaColumnName As String = "Column Name"
Const DefaultColumnName As String = "Column "
Const nonSchemaHeadingIndex As Integer = 0

Dim emptySchema As Boolean = Schema Is Nothing OrElse Schema.Rows.Count = 0

Dim csvValuesList = ParseCsvToList(CSV)

' If we want to parse with no schema and want the first row be used as headings 
' we need to know what the headings will be.
Dim nonSchemaHeadings = csvValuesList(nonSchemaHeadingIndex)

' Arrange the column headings into the table first.
If emptySchema Then
	For Each columnHeader As String In nonSchemaHeadings
		Dim colName As String = If(FirstRowIsHeader, columnHeader,
											 DefaultColumnName & outputCollection.Columns.Count)
		outputCollection.Columns.Add(colName, GetType(String))
	Next
Else
	For Each columnHeader As DataRow In Schema.Rows
		Dim colName As String = columnHeader(SchemaColumnName).ToString
		outputCollection.Columns.Add(colName, GetType(String))
	Next
End If

' If the first row is being used for headings then skip those headings / values in csvValuesList.
Dim startListIndex As Integer = If(FirstRowIsHeader, nonSchemaHeadingIndex + 1, nonSchemaHeadingIndex)

' Insert the csv values into the table row by row.
For i As Integer = startListIndex To csvValuesList.Count - 1
	Dim currentRow As Datarow = outputCollection.NewRow
	outputCollection.Rows.Add(currentRow)

	Dim csvArray = csvValuesList(i)
	For columnIndex As Integer = 0 To csvArray.Length - 1
		currentRow.Item(columnIndex) = csvArray(columnIndex)
	Next
Next]]></code></stage><stage stageid="feb4e385-2919-4066-86ad-53cb6226c867" name="InStr" type="SubSheetInfo"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><narrative>Tests to see if one peice of text contains another peice of sub text.</narrative><display x="-150" y="-180" w="150" h="90" /></stage><stage stageid="353f092b-3d6f-4fda-bdab-cd5798047c44" name="End" type="End"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><loginhibit /><display x="15" y="60" /><outputs><output type="number" name="Position" narrative="The index of the sub text within the text or -1 if not found" stage="Position" /></outputs></stage><stage stageid="f594335d-8723-4704-a8ae-e8dbcfe492c7" name="Text" type="Data"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><display x="-180" y="-30" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1a43e2c2-c8c1-4dfd-b58f-2775e2ea7d0e" name="Search String" type="Data"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><display x="-180" y="0" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c9bbb24e-51f9-489f-9944-30d9612c396a" name="Start Byte" type="Data"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><display x="-180" y="30" w="150" h="30" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="65e660c1-4379-4323-9e01-6cd7ae38f150" name="Note1" type="Note"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><loginhibit /><narrative>Inputs</narrative><display x="-180" y="-60" w="150" h="30" /></stage><stage stageid="424c6e04-b000-4dce-8eb7-ba00b0fea671" name="InStr" type="Code"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><loginhibit /><display x="15" y="-15" /><inputs><input type="text" name="InText" expr="[Text]" /><input type="text" name="Search String" expr="[Search String]" /><input type="number" name="Start Byte" expr="[Start Byte]" /><input type="number" name="Compare Method" expr="[Compare Method]" /></inputs><outputs><output type="number" name="Position" stage="Position" /></outputs><onsuccess>353f092b-3d6f-4fda-bdab-cd5798047c44</onsuccess><code><![CDATA[  Position = Microsoft.VisualBasic.InStr(Start_Byte,InText, Search_String, 1)]]></code></stage><stage stageid="7f283fb0-e9fa-4e24-82d1-aae53fd5afe1" name="Position" type="Data"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><display x="-165" y="165" w="150" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d00b9153-969d-4db4-b737-b1ac835c7b2a" name="Compare Method" type="Data"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><loginhibit /><narrative>1 = text, 0 = binary</narrative><display x="-180" y="60" w="150" h="30" /><datatype>number</datatype><initialvalue>1</initialvalue><private /><alwaysinit /></stage><stage stageid="4bbb2261-2d01-49a5-88e8-c8d37745fd60" name="InStrRev" type="SubSheetInfo"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><narrative>Tests to see if one peice of text contains another peice of sub text but matches in reverse.</narrative><display x="-150" y="-135" w="150" h="90" /></stage><stage stageid="3ddcb7e5-570f-430d-8374-ed9066da51c0" name="Start" type="Start"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="Text" narrative="Text to search in" stage="Text" /><input type="text" name="Search String" narrative="The text to search for" stage="Search String" /><input type="number" name="Start Byte" narrative="Where in the string to search from" stage="Start Byte" /><input type="number" name="Compare Method" narrative="1=text, 0=binary" stage="Compare Method" /></inputs><onsuccess>4991333f-9a42-4dc3-b73b-a8bc97edab6d</onsuccess></stage><stage stageid="251f9278-c41e-44a0-835b-bfc48910933d" name="Text" type="Data"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><display x="-180" y="-30" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="393bbd43-ae95-438d-b358-f51cc69d5e5c" name="Search String" type="Data"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><display x="-180" y="0" w="150" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a898a11a-c6ca-4a70-abcd-42f38192de24" name="Start Byte" type="Data"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><display x="-180" y="30" w="150" h="30" /><datatype>number</datatype><initialvalue>-1</initialvalue><private /><alwaysinit /></stage><stage stageid="73737012-9282-4e33-9d87-c4718367216d" name="Note1" type="Note"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><loginhibit /><narrative>Inputs</narrative><display x="-180" y="-60" w="150" h="30" /></stage><stage stageid="4991333f-9a42-4dc3-b73b-a8bc97edab6d" name="InStrRev" type="Code"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><loginhibit /><display x="15" y="-15" /><inputs><input type="text" name="InText" expr="[Text]" /><input type="text" name="Search String" expr="[Search String]" /><input type="number" name="Start Byte" expr="[Start Byte]" /><input type="number" name="Compare Method" expr="[Compare Method]" /></inputs><outputs><output type="number" name="Position" stage="Position" /></outputs><onsuccess>ba288c3f-ff29-4df2-af77-a2823f65f60c</onsuccess><code><![CDATA[  Position = Microsoft.VisualBasic.InStrRev(InText, Search_String, Start_Byte, 1)]]></code></stage><stage stageid="63d5b70d-b54a-4451-b957-9ea177292994" name="Position" type="Data"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><display x="-165" y="150" w="150" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="57a39985-6197-4f21-bdff-e46bd897faa6" name="Compare Method" type="Data"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><loginhibit /><narrative>1 = text, 0 = binary</narrative><display x="-180" y="60" w="150" h="30" /><datatype>number</datatype><initialvalue>1</initialvalue><private /><alwaysinit /></stage><stage stageid="d0bb7b29-fbb3-43cd-ab69-7f76a9c657e5" name="Note1" type="Note"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><loginhibit /><narrative>Outputs</narrative><display x="-165" y="120" w="150" h="30" /></stage><stage stageid="b27c7a93-8e3b-4ed8-b105-e08cd2c96fdf" name="Note1" type="Note"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><loginhibit /><narrative>Outputs</narrative><display x="-165" y="135" w="150" h="30" /></stage><stage stageid="bc4f3574-a096-4b9f-b836-0bc100bf2a18" name="Start" type="Start"><subsheetid>0244396a-1d3d-4892-b6cb-461468f4c7e1</subsheetid><loginhibit /><preconditions><condition narrative="" /></preconditions><display x="15" y="-90" /><inputs><input type="text" name="Text" narrative="Text to search in" stage="Text" /><input type="text" name="Search String" narrative="The text to search for" stage="Search String" /><input type="number" name="Start Byte" narrative="Where in the string to search from" stage="Start Byte" /><input type="number" name="Compare Method" narrative="1=text, 0=binary" stage="Compare Method" /></inputs><onsuccess>424c6e04-b000-4dce-8eb7-ba00b0fea671</onsuccess></stage><stage stageid="ba288c3f-ff29-4df2-af77-a2823f65f60c" name="End" type="End"><subsheetid>9ab28c01-86eb-458d-b8d9-74f98926d266</subsheetid><loginhibit /><display x="15" y="75" /><outputs><output type="number" name="Position" narrative="The index of the sub text within the text from the end or -1 if not found" stage="Position" /></outputs></stage><stage stageid="73739a66-400b-488a-bd7a-63a2f0d2a4ef" name="Test Regex Match" type="SubSheetInfo"><subsheetid>a6b6398e-c21a-4c4e-9742-65ccad8370d9</subsheetid><narrative>Check if a given Text value matches a regular expression.</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="568b67f8-4216-4af4-bea8-1c83bbff7e16" name="Start" type="Start"><subsheetid>a6b6398e-c21a-4c4e-9742-65ccad8370d9</subsheetid><loginhibit /><display x="-30" y="-120" /><inputs><input type="text" name="Regex Pattern" narrative="The regex pattern to apply" stage="Regex Pattern" /><input type="text" name="Target String" narrative="The target string to which apply the pattern and extract values" stage="Target String" /></inputs><onsuccess>2ad0c111-6108-4ca5-945b-22aab4b6bb27</onsuccess></stage><stage stageid="46282093-d3a9-4e38-b030-95b332ec5371" name="End" type="End"><subsheetid>a6b6398e-c21a-4c4e-9742-65ccad8370d9</subsheetid><loginhibit /><display x="-30" y="75" /><outputs><output type="flag" name="Matched?" narrative="Whether or not the regex match" stage="Regex Match" /></outputs></stage><stage stageid="32d3ef8a-d0b2-4093-afc5-98bad356c881" name="Regex Pattern" type="Data"><subsheetid>a6b6398e-c21a-4c4e-9742-65ccad8370d9</subsheetid><display x="165" y="-120" w="300" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5747c96e-0ce3-4e78-b446-17b9cef5b655" name="Target String" type="Data"><subsheetid>a6b6398e-c21a-4c4e-9742-65ccad8370d9</subsheetid><narrative>100-200
56 to 99
400 - 600</narrative><display x="165" y="-75" w="300" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2ad0c111-6108-4ca5-945b-22aab4b6bb27" name="Test Regex Match1" type="Code"><subsheetid>a6b6398e-c21a-4c4e-9742-65ccad8370d9</subsheetid><loginhibit /><display x="-30" y="-30" /><inputs><input type="text" name="Regex Pattern" expr="[Regex Pattern]" /><input type="text" name="Target String" expr="[Target String]" /></inputs><outputs><output type="flag" name="Regex Match" stage="Regex Match" /></outputs><onsuccess>46282093-d3a9-4e38-b030-95b332ec5371</onsuccess><code><![CDATA[
Dim R as New Regex(Regex_Pattern, RegexOptions.SingleLine)
Dim M as Match = R.Match(Target_String)
Regex_Match =  M IsNot Nothing AndAlso M.Success]]></code></stage><stage stageid="24d6e567-f121-4d8a-a4ee-1402f8f2832d" name="Regex Match" type="Data"><subsheetid>a6b6398e-c21a-4c4e-9742-65ccad8370d9</subsheetid><display x="45" y="-30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage></process></object>
        <process-group id="122d0eb4-918f-463a-b772-67911f8e074d" name="01 Productos/Actualizar comisiones web pyme" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/process-group">
            <members>
                <process id="ea1de96a-ddbb-4a04-a61a-0038894ea7a6" />
            </members>
        </process-group>
        <object-group id="9b45b062-aeb8-40fc-bf75-58b5e0ed8954" name="00 Utilidades/Utility BP" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="1b13f5b8-01d1-441e-bd7f-54884a24d71f" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>